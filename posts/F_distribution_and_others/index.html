<!DOCTYPE html><html lang="ko-KR" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[수학/확률과 통계] F분포, 다변수정규분포(조건부분포, 주변분포 포함)" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="공부 중인 내용을 정리한 글" /><meta property="og:description" content="공부 중인 내용을 정리한 글" /><link rel="canonical" href="https://tigerkey10.github.io/bioinfo.github.io/posts/F_distribution_and_others/" /><meta property="og:url" content="https://tigerkey10.github.io/bioinfo.github.io/posts/F_distribution_and_others/" /><meta property="og:site_name" content="der Wille zur Macht" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-25T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[수학/확률과 통계] F분포, 다변수정규분포(조건부분포, 주변분포 포함)" /><meta name="google-site-verification" content="1CLBUlwAX10LXrW4RzkPuaeWtey34c3dyngs14cKrCw" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-07-25T00:00:00+09:00","datePublished":"2021-07-25T00:00:00+09:00","description":"공부 중인 내용을 정리한 글","headline":"[수학/확률과 통계] F분포, 다변수정규분포(조건부분포, 주변분포 포함)","mainEntityOfPage":{"@type":"WebPage","@id":"https://tigerkey10.github.io/bioinfo.github.io/posts/F_distribution_and_others/"},"url":"https://tigerkey10.github.io/bioinfo.github.io/posts/F_distribution_and_others/"}</script><title>[수학/확률과 통계] F분포, 다변수정규분포(조건부분포, 주변분포 포함) | der Wille zur Macht</title><link rel="apple-touch-icon" sizes="180x180" href="/bioinfo.github.io/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/bioinfo.github.io/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/bioinfo.github.io/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/bioinfo.github.io/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/bioinfo.github.io/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="der Wille zur Macht"><meta name="application-name" content="der Wille zur Macht"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/bioinfo.github.io/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/bioinfo.github.io/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'] ], processEscapes: true, } }); MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/bioinfo.github.io/" class="mx-auto"> <img src="/bioinfo.github.io/assets/img/emoge.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/bioinfo.github.io/">der Wille zur Macht</a></div><div class="site-subtitle font-italic">10,000 Hours</div></div><ul class="w-100"><li class="nav-item"> <a href="/bioinfo.github.io/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/bioinfo.github.io/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/bioinfo.github.io/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/bioinfo.github.io/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>타임라인</span> </a><li class="nav-item"> <a href="/bioinfo.github.io/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="https://github.com/tigerkey10" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kkb1004tom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/bioinfo.github.io/"> Home </a> </span> <span>[수학/확률과 통계] F분포, 다변수정규분포(조건부분포, 주변분포 포함)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[수학/확률과 통계] F분포, 다변수정규분포(조건부분포, 주변분포 포함)</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1627138800" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2021-07-25 </em> </span> <span> 업데이트 <em class="" data-ts="1627171200" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2021-07-25 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4078 단어"> <em>22 분</em>읽는 시간</span></div></div></div><div class="post-content"><h1 id="f분포--카이제곱분포-표본각각의-자유도-의-비율들이-이루는-분포">F분포 : 카이제곱분포 표본/각각의 자유도 의 비율들이 이루는 분포</h1><ul><li>모수 : 자유도 쌍 $(N1, N2)$<li>자유도 : $(N1, N2)$<li>카이제곱분포 표본 = 같은 정규분포에서 얻은 표본들의 제곱합<li><h2 id="t통계량-제곱의-분포도-자유도가-1n-인-f분포-따른다"><span class="mr-2">t통계량 제곱의 분포도 자유도가 $(1,N)$ 인 F분포 따른다.</span><a href="#t통계량-제곱의-분포도-자유도가-1n-인-f분포-따른다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1"># t 통계량 제곱의 분포는 F(1, N)를 따른다. 
# N = 2
</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'t통계량 제곱의 분포'</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'f분포 : 자유도 = (1,2)'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="1080" alt="Screen Shot 2021-07-22 at 11 53 18" data-src="https://user-images.githubusercontent.com/83487073/126583832-fc5322f9-f0a9-4f5b-8c9c-12500fb375f0.png" data-proofer-ignore></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1"># 2. N=30
</span><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">t</span><span class="p">(</span><span class="n">N</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'t통계량 제곱의 분포'</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">f</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'f 분포 : 자유도 = (1,30)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="1078" alt="Screen Shot 2021-07-22 at 11 53 57" data-src="https://user-images.githubusercontent.com/83487073/126583876-f8f0f27c-6854-4170-b2e9-11029b8c833a.png" data-proofer-ignore></p><hr /><p>혹은</p><hr /><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1"># 다시해보기 
</span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">t</span><span class="p">(</span><span class="n">N</span><span class="p">).</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">).</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s">'t통계량 제곱 분포 | 자유도 = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s">'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s">'f분포 표본 | 자유도 = (1, </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s">)'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">'mid'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'b'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s"> 인 경우'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="1072" alt="Screen Shot 2021-07-22 at 12 10 15" data-src="https://user-images.githubusercontent.com/83487073/126584915-be9db744-b05c-457b-8df1-25fd3c781801.png" data-proofer-ignore></p><hr /><h1 id="f분포-특징">F분포 특징</h1><ul><li>직관적으로 생각했을 때, $N1 = N2$ 일 경우 1근처 어떤 값이 가장 자주 나올 거라 생각된다.</ul><p>그 이유는 다음과 같다.</p><p>카이제곱분포 표본은 같은 정규분포에서 나온다.</p><p>표본 갯수인 $N1, N2$ 가 같다면, 아무래도 정규분포 상에서 확률밀도 높은쪽에서 N개 표본이 자주 발생할 것이다.</p><p>예) 기댓값, 최빈값 근처</p><p>이 경우 카이제곱분포 표본값(정규분포 표본 제곱합)도 2개가 서로 비슷비슷한 값일 거다.</p><p>$N1, N2$ 가 서로 같기 때문에 약분하면 결국 분자 분모에 서로 비슷비슷한 값이 남는다.</p><p>이 비율값은 대략 1 근처 값이라 생각할 수 있다.</p><p>이 경우 ‘자주 발생하는 F분포 표본값’은 ‘1근처 값 이다’ 라고 직관적으로 생각할 수 있다.</p><p>하지만 실제로는 1이 아닌 다른 어떤 값이 더 자주 나온다.</p><ul><li><p>이 현상은 $N1=N2$ 값이 커질수록 사라진다.</p><li><p>결국 1 근처 값이 가장 자주 발생하게 된다.</p></ul><h3 id="f분포-특징--n1n2-가-커질-수록-1근처-값이-가장-자주-발생한다"><span class="mr-2">F분포 특징 : $N1=N2$ 가 커질 수록 1근처 값이 가장 자주 발생한다.</span><a href="#f분포-특징--n1n2-가-커질-수록-1근처-값이-가장-자주-발생한다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="n">N</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">rv</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">rv</span><span class="p">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="p">(</span><span class="n">rv</span><span class="p">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">x1</span><span class="o">/</span><span class="n">x2</span>
    <span class="n">sns</span><span class="p">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">':'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'자유도 : </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'F분포 자유도 (N1,N2)가 커질 수록 1근처 값이 가장 자주 나온다'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="1075" alt="Screen Shot 2021-07-22 at 11 08 44" data-src="https://user-images.githubusercontent.com/83487073/126581367-341491b0-d652-402f-97bf-4d96b0664804.png" data-proofer-ignore></p><hr /><h1 id="다변수-정규분포">다변수 정규분포</h1><ul><li>다변수 정규분포 차원은 확률변수벡터 차원 따라간다</ul><hr /><h1 id="메모">메모</h1><h1 id="고윳값-lambda1-lambda2는-곧-확률변수-x1의-분산-x2의-분산값과-같다">고윳값 lambda1, lambda2는 곧 확률변수 X1의 분산, X2의 분산값과 같다.</h1><ol><li>다변수정규분포 확률밀도함수 식을 보면 이 확률밀도함수는 타원이다. (반지름 다양한 여러 개 타원을 이룬다)<li><p>타원 식을 보면 타원 반지름은 ld1, ld2 값에 비례한다.</p><li>곧, ld1, ld2값은 ‘사실상’ 타원 반지름이라 볼 수 있다.<li>타원 반지름 = 타원 사이즈 다.<li>타원 사이즈 = 값들의 분포 정도 (X1쪽, X2쪽으로 각각 값들이 얼마나 퍼져 있는가(평균을 중심으로))<li><p>값들의 분포정도 = X1, X2의 분산 (분산 : 평균을 중심으로 퍼져있는 정도)</p><li>타원 반지름 = X1, X2의 분산<li>$ld1, ld2 = V[X1 ], V[X2 ]$</ol><h2 id="-공분산-행렬에-w--npdiagld1-ld2-를-넣는-이유"><span class="mr-2">–&gt; 공분산 행렬에 w = np.diag([ld1, ld2]) 를 넣는 이유</span><a href="#-공분산-행렬에-w--npdiagld1-ld2-를-넣는-이유" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h1 id="메모-2">메모 2</h1><h1 id="다변수정규분포함수-확률밀도함수-모양-방향-사이즈의-의미">다변수정규분포함수 확률밀도함수 모양, 방향, 사이즈의 의미</h1><h1 id="표준기저벡터-직교좌표계에서">표준기저벡터 직교좌표계에서</h1><ul><li>모양 : 타원<li>중심 : mu<li>분포사이즈(타원 반지름) 는 공분산행렬 고윳값에 비례한다<li>분포방향은 공분산행렬 고유벡터 방향이다</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>

<span class="n">rv</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rv</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">dstack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">])))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="mf">0.35</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xytext</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">xytext</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'좌표변환 전'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x_1$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$x_2$'</span><span class="p">)</span>



<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rv2</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">rv2</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">dstack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">])))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'좌표변환 후'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x_1$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$x_2$'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'다변수정규분포 결합확률밀도함수'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="1078" alt="Screen Shot 2021-07-24 at 16 20 41" data-src="https://user-images.githubusercontent.com/83487073/126860836-86da6f39-e1ca-46fb-8a13-108d03fbbbec.png" data-proofer-ignore></p><h1 id="한편">한편</h1><ul><li>확률변수들의 공분산 값도 대략적인 분포 방향 알게 해준다<li>단변수 확률변수 분산값도 대략적인 분포 사이즈 알게 해준다</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>

<span class="n">rv</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rv</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">dstack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">])))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'X1, X2 공분산이 0이고 단변수확률변수 분산 4인 경우'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'다 같은데 X1, X2 공분산만 -3으로 바뀌면'</span><span class="p">)</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>

<span class="n">rv</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rv</span><span class="p">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">dstack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">])))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="mf">0.35</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xytext</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">xytext</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s">':'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="1074" alt="Screen Shot 2021-07-24 at 16 25 04" data-src="https://user-images.githubusercontent.com/83487073/126860962-174cedb2-976b-45d5-ba8d-3e13a1bc3d9e.png" data-proofer-ignore></p><hr /><h1 id="메모-3">메모 3</h1><h1 id="matplotlib로-벡터-화살표-표현하기">matplotlib로 벡터 화살표 표현하기</h1><h1 id="pltannotate">plt.annotate()</h1><p>주요 arguments</p><ul><li>텍스트 내용 입력 / 예) ‘ ‘<li>$xy$ = 가리킬 끝점 / 예) $v[:,0 ]$<li>xytext = 화살표 시작점 / 예) $mu$<li>arrowprops = d</ul><p>화살표로서 벡터 표현에 요긴하게 쓸 수 있었다.</p><hr /><h1 id="다변수정규분포-조건부확률분포">다변수정규분포-조건부확률분포</h1><h1 id="다변수정규분포-따르는-결합확률분포의-조건부확률분포는-다변수정규분포-따른다">다변수정규분포 따르는 결합확률분포의 ‘조건부확률분포’는 다변수정규분포 따른다.</h1><ul><li><p>D차원 입력벡터 만들어내는 확률변수 x가 있다. 이 확률변수 x는 $N(X \vert \mu, \Sigma)$ 다변수 정규분포를 따른다고 하자.</p><li><p>입력벡터 X의 표본인 D차원 벡터를 열벡터로 쌓아 만든 행렬을 X라 하자.</p><li><p>이 행렬 X를 분할해서 두 개 행렬로 나누자. 다음과 같이 표기할 수 있다.</p></ul><p>$X$ = [[$X_{a}$ ], [$X_{b}$ ]] (열로 생각하자)</p><p>이거는 <img width="867" alt="Screen Shot 2021-07-25 at 18 03 55" data-src="https://user-images.githubusercontent.com/83487073/126893726-1671b154-de2b-46f0-9f53-d4a74f637040.png" data-proofer-ignore></p><p>와 같다.</p><ul><li><p>$X_{a}$ 의 벡터 1개는 M차원을 갖고, $X_{b}$의 벡터 1개는 D-M 차원을 갖는다.</p><li><p>행렬 단위에서는 $X_{a}$ 는 (M*N),</p><li><p>$X_{b}$는 ((D-M)*N) 행렬일 것이다.</p><li><p>이 때 대응되는 평균은 다음과 같다.</p></ul><p>$\mu$ = [[$\mu_{a}$ ], [$\mu_{b}$ ]]</p><p>$\mu_{a}$ 는 행렬 $X_{a}$에 벡터들의 평균이다.</p><p>$\mu_{b}$ 는 행렬 $X_{b}$에 벡터들의 평균이다.</p><ul><li>공분산행렬은 다음과 같다.</ul><p>$\Sigma$ = [[$\Sigma_{aa}$, $\Sigma_{ab}$ ],[$\Sigma_{ba}$, $\Sigma_{bb}$ ]]</p><p>예를들어 $\Sigma_{aa}$는 다음과 같다.</p><p><img width="1067" alt="Screen Shot 2021-07-25 at 18 05 22" data-src="https://user-images.githubusercontent.com/83487073/126893781-134be4a0-53a4-4155-894a-79827df4a50a.png" data-proofer-ignore></p><ul><li>$X_{a}$ 와 $X_{b}$ 간 공분산은</ul><p><img width="1027" alt="Screen Shot 2021-07-25 at 18 06 37" data-src="https://user-images.githubusercontent.com/83487073/126893833-68e06e8c-c5ae-4b6f-87da-851c625de37a.png" data-proofer-ignore></p><ul><li>$\Sigma_{ab}$ 도 마찬가지다.</ul><p><img width="949" alt="Screen Shot 2021-07-25 at 18 07 29" data-src="https://user-images.githubusercontent.com/83487073/126893856-54befed7-f835-4501-8500-411ecf997a37.png" data-proofer-ignore></p><ul><li><p>이렇게 해서 $\Sigma$ = [[$\Sigma_{aa}$, $\Sigma_{ab}$ ],[$\Sigma_{ba}$, $\Sigma_{bb}$ ]] 가 나온다.</p><li><p>공분산 행렬 $\Sigma$ 는 대칭행렬이다. 따라서 $\Sigma^{T}$ = $\Sigma$ 다.</p><li><p>따라서 $\Sigma_{ba}$ = $\Sigma_{ab}$ 다.</p><li><p>정밀도행렬(공분산행렬의 역행렬)은 다음과 같이 정의할 수 있다.</p></ul><p>$\Lambda$ = $\Sigma^{-1}$</p><p>참고로 $\Sigma$ 는 풀랭크(모든 열이 서로 독립) 이므로 항상 역행렬 존재한다.</p><ul><li>$\Lambda$ 는 다음처럼 정의할 수 있다.</ul><p>$\Lambda$ = [[$\Lambda_{aa}$ , $\Lambda_{ab}$ ],[$\Lambda_{ba}$ , $\Lambda_{bb}$]]</p><ul><li>$\Lambda$ 도 대칭행렬이다. (대칭행렬 $\Sigma$ 의 역행렬은 대칭행렬이다)</ul><p>$\Lambda_{ab}$ = $\Lambda_{ba}$ 성립한다.</p><ul><li>단, $\Lambda_{aa}$ 는 $\Sigma_{aa}$ 역행렬 구한다고 얻을 수 있는 게 아니다.</ul><p>공분산의 부분행렬의 역행렬이 부분행렬의 정밀도 행렬이라 정의할 수 없다.</p><ul><li><p>우리가 찾는 건 $p(X_{a} \vert X_{b})$ 의 확률분포다.</p><li><p>여기서 현재의 결합확률분포 $p(X)$ = $p(X_{a} \vert X_{b})$ 로 나타낼 수 있다.</p></ul><p>X는 맨 처음 언급했던, D차원 벡터 만들어내는 확률변수 X다.</p><ul><li>만약 여기서 $X_{b}$ 가 고정된 값이라면 $X_{a}$ 의 조건부 확률분포 얻을 수 있을 것이다.</ul><hr /><h2 id="정규분포-지수의-이차형식-꼴에-x-mu-등을-넣어서-지수의-이차형식-꼴로-정리된다면-x가-정규분포-따르게-될-것이라-볼-수-있다"><span class="mr-2">정규분포 ‘지수의 이차형식’ 꼴에 X, $\mu$ 등을 넣어서 지수의 이차형식 꼴로 정리된다면, X가 정규분포 따르게 될 것이라 볼 수 있다.</span><a href="#정규분포-지수의-이차형식-꼴에-x-mu-등을-넣어서-지수의-이차형식-꼴로-정리된다면-x가-정규분포-따르게-될-것이라-볼-수-있다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>또 정리된 식에서 평균, 공분산 구할 수 있어야 한다.</p><p>만약 지수의 이차형식 꼴로 정리되면서, 평균, 공분산 구할 수 있으면 X의 분포가 정규분포 따른다’ 고 할 수 있다.</p><hr /><ul><li>지수의 이차형식</ul><p>$\Delta^{2}$ = $-(1/2)*$ $(X-\mu)^{T}$ $\Sigma^{-1}$ $(X-\mu)$</p><hr /><ul><li>위 식에 $X$ 와 $\mu$ 를 넣어서 식을 전개해보자.</ul><p><img width="1090" alt="Screen Shot 2021-07-25 at 18 10 42" data-src="https://user-images.githubusercontent.com/83487073/126893920-614aa3d2-d75d-4511-80fb-15342acaf1ee.png" data-proofer-ignore></p><ul><li><p>앞에서 $X_{b}$ 는 특정한 값에 고정되어 있다고 생각하기로 했다.</p><li><p>따라서 위 식은 그냥 $X_{a}$ 에 대한 식이라 볼 수 있다.</p><li><p>또, 정리하면 이차형식 꼴이 된다.</p><li><p>이차형식에서 평균과 공분산 구할 수 있으면 ‘정규분포 따른다’고 할 수 있다.</p></ul><hr /><h2 id="정규분포의-이차형식-구조를-좀-더-살펴보자"><span class="mr-2">정규분포의 이차형식 구조를 좀 더 살펴보자.</span><a href="#정규분포의-이차형식-구조를-좀-더-살펴보자" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>$-(1/2)*$ $(X-\mu)^{T}$ $\Sigma^{-1}$ $(X-\mu)$</p><p>$=$ $-(1/2)*X^{T} \Sigma^{-1}X$ $+$ $X^{T} \Sigma^{-1} \mu$ + $const$</p><p>이 전개 방식을 ‘completing the square’라 부른다.</p><ul><li><p>$const$ 영역은 $X$ 와는 독립적인 영역이다.</p><li><p>이차형식을 두번 미분한 값은(즉 2차식 계수에 주목해야 한다) $\Sigma^{-1}$ 이 된다.</p><li><p>이를 통해 공분산의 역행렬을 구할 수 있다. ($\Sigma^{-1}$)</p><li><p>다음으로 1차식 계수는 $\Sigma^{-1} \mu$ 가 된다.</p><li><p>따라서 공분산행렬 구한 다음, 1차항 계수에서 평균벡터 $\mu$ 를 구할 수 있다.</p></ul><hr /><ul><li>이제 조건부 분포의 평균과 분산을 구해보자.<li>$X_{a}$ 와 $X_{b}$ 로 표현된 이차형식 영역을 $X_{a}$ 에 대해 두번 미분한다고 하면, 2차식 부분은 다음과 같다.</ul><p>$-(1/2)*X_{a}^{T} \Lambda_{aa} X_{a}$</p><ul><li><p>$X_{b}$ 와 관련된 영역은 모두 상수취급하면 된다.</p><li><p>두번 미분한 값(2차 항의 계수) 은 공분산의 역행렬과 같았다. 따라서, 조건부분포 $p(X_{a} \vert X_{b})$ 의 공분산은 다음과 같다.</p><li><p>$\Sigma_{a\vert b}$ $=$ $\Lambda_{aa}^{-1}$</p><li><p>이제 평균을 구하기 위해 $X_{a}$ 의 1차식 계수를 확인해 보자.</p></ul><p>1차식 계수는</p><p>$X_{a}^{T}${$\Lambda_{aa}$ $\mu$ - $\Lambda_{bb} (X_{b} - \mu_{b})$}</p><p>이다.</p><ul><li>$\Lambda_{ba}^{T}$ $=$ $\Lambda_{ab}$ 였다.</ul><p>(앞에서 대칭행렬 설명할 때)</p><ul><li><p>위 식은 앞에서 계산한 $\Sigma_{a \vert b}^{-1} \mu_{a \vert b}$ 와 같아져야 한다.</p><li><p>식을 전개하면 다음과 같다.</p></ul><p>$\Sigma_{a \vert b}^{-1}\mu_{a \vert b} = [\Lambda_{aa}\mu_{a} - \Lambda_{ab}(X_{b}-\mu_{b})]$</p><p>$\Rightarrow$ $\mu_{a \vert b} = \Sigma_{a \vert b} [ \Lambda_{aa} \mu_{a} - \Lambda_{ab} (X_{b} - \mu_{b}) ]$</p><p>$\Rightarrow$ 앞에서 $(\Sigma_{a \vert b} = \Lambda_{aa}^{-1})$ 이었다. 적용하면</p><p>$\Rightarrow$ $\mu_{a\vert b} = \Lambda_{aa}^{-1}$ $[\Lambda_{aa}\mu_{a} - \Lambda_{ab} (X_{b} - \mu_{b})]$</p><ul><li>$\mu_{a \vert b}$ $=$ $\mu_{a} - \Lambda_{aa}^{-1}\Lambda_{ab}(X_{b}-\mu_{b})$ 이 된다.</ul><hr /><ul><li>평균과 분산을 정밀도 행렬 $\Lambda$ 말고, $\Sigma$ 로 표현해보자.</ul><p><img width="720" alt="Screen Shot 2021-07-25 at 18 11 39" data-src="https://user-images.githubusercontent.com/83487073/126893956-ae39a9ed-1cdc-413b-8bfb-25274f6e3cf8.png" data-proofer-ignore></p><ul><li><p>$M^{-1}$ 은 schur completement라 불리는 행렬을 의미한다.</p><li><p>이 식을 아래 행렬에 대입해서 풀어본다.</p></ul><p><img width="725" alt="Screen Shot 2021-07-25 at 18 12 30" data-src="https://user-images.githubusercontent.com/83487073/126893979-05f69c16-b672-481c-b248-60e1dcb04bf6.png" data-proofer-ignore></p><ul><li>$\Lambda_{aa} = (\Sigma_{aa} - \Sigma_{ab} \Sigma_{bb}^{-1}\Sigma_{ba})^{-1}$<li>$\Lambda_{ab} = -(\Sigma_{aa}-\Sigma_{ab}\Sigma_{bb}^{-1}\Sigma_{ba})^{-1}$ $\Sigma_{ab}\Sigma_{bb}^{-1}$</ul><p>여기서 얻은 결과를 $p(X_{a} \vert X_{b})$ 의 평균. 분산에 대입하면</p><ul><li>$\mu_{a \vert b} = \mu_{a} + \Sigma_{aa}\Sigma_{bb}^{-1}(X_{b}-\mu_{b})$<li>$\Sigma_{a \vert b} = \Sigma_{aa} - \Sigma_{ab}\Sigma_{bb}^{-1}\Sigma_{ba}$</ul><p>가 나온다.</p><hr /><h2 id="결론"><span class="mr-2">결론</span><a href="#결론" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>$\mu_{a \vert b}$ 는 $X_{b}$ 에 대한 선형함수 꼴이다.<li><p>$\Sigma_{a \vert b}$ 는 $X_{b}$ 에 대해 독립적인 식이다.</p><li>$X_{2}$ 가 어떤 값으로 주어지면 $X_{1}$의 조건부확률분포는 조건부 기댓값 $\mu_{a \vert b}$, 조건부공분산 행렬 $\Sigma_{a \vert b}$ 갖는 다변수 정규분포를 따르게 된다.</ul><hr /><h1 id="다변수정규분포-따르는-결합확률분포의-주변확률분포도-다변수정규분포-따른다">다변수정규분포 따르는 결합확률분포의 주변확률분포도 다변수정규분포 따른다.</h1><ul><li><p>앞에서는 $p(X_{a}, X_{b})$ 분포가 다변수정규분포이면 $p(X_{a} \vert X_{b})$ 분포도 다변수 정규분포가 된다는 걸 확인했다.</p><li><p>그렇다면 주변확률분포는 어떨까?</p></ul><p>$p(X_{a}) = \int p(X_{a}, X_{b})dX_{b}$ &lt; 주변확률분포 식 &gt;</p><p>위 주변확률분포가 ‘지수의 이차형식’ 꼴로 정리되고,</p><ul><li>평균<li>분산</ul><p>구할 수 있으면 정규분포 따른다고 할 수 있다.</p><ul><li>지수의 이차형식은 앞에서 다음과 같았다.</ul><p>$-(1/2)*(X-\mu)^{T}\Sigma^{-1}(X-\mu)$</p><p>$= -(1/2)*X^{T}\Sigma^{-1}X + X^{T}\Sigma^{-1}\mu + const$</p><ul><li>$X$ 에 $[[X_{a}],[X_{b}]]$ 넣고 $\mu$ 에 $[[\mu_{a}],[\mu_{b}]]$ 넣어서 전개하면 다음과 같다.</ul><p>$-(1/2)*X_{b}^{T}\Lambda_{bb}X_{b} + X^{T}_{b}m$</p><p>$= -(1/2)(X_{b}-\Lambda_{bb}^{-1}m)^{T}\Lambda_{bb}(X_{b}-\Lambda_{bb}^{-1}m)+(1/2)m^{T}\Lambda_{bb}^{-1}m$</p><ul><li><p>위 식은 $X_{b}$ 에 대한 2차식으로 부분 변형하고, $(1/2)*m^{T}\Lambda_{bb}^{-1}m$ 을 보충해준 식이다.</p><li><p>$m = \Lambda_{aa}\mu_{b}-\Lambda_{ba}(X_{a}-\mu_{a})$</p><li><p>$X_{b}$ 로 적분해보자.</p></ul><p>첫번째 항 $-(1/2)(X_{b}-m^{T})\Lambda_{bb}(X_{b}-\Lambda_{bb}^{-1}m)$ 은 $X_{b}$ 에 대한 식이다.</p><p>두번째 항 $(1/2)m^{T}\Lambda_{aa}^{-1}m$ 은 $X_{a}$ 에만 종속되는 식이다.</p><hr /><ul><li>적분한 식을 $X_{a}$ 에 대해 정리한다.</ul><p>$(1/2)[\Lambda_{bb}\mu_{b}-\Lambda_{ba}(X_{a}-\mu_{a})]^{T}\Lambda_{bb}^{-1}[\Lambda_{bb}\mu_{b}-\Lambda_{ba}(X_{a}-\mu_{a})]-(1/2)X_{a}^{T}\Lambda_{aa}X_{a}+X_{a}^{T}(\Lambda_{aa}\mu_{a}+\Lambda_{ab}\mu_{b})+const$</p><p>$= -(1/2)X_{a}^{T}(\Lambda_{aa}-\Lambda_{ab}\Lambda_{bb}^{-1}\Lambda_{ba})X_{a} + X_{a}^{T}(\Lambda_{aa}-\Lambda_{ab}\Lambda_{bb}^{-1}\Lambda_{ba})\mu_{a}+const$</p><ul><li><p>이것 역시 이차형식 꼴이다. 따라서 $p(X_{a})$ 가 정규분포 따를 것이라 예상할 수 있다.</p><li><p>이제 위 식에서 평균. 분산만 구할 수 있으면 ‘$p(X_{a})$ 는 정규분포 따른다’고 말할 수 있다.</p></ul><p>복기해보면, 공분산은 이차형식 내 2차식의 계수, 평균은 이차형식 내 1차식의 계수와 같았다.</p><ul><li>이차식 계수 = $\Lambda_{aa}-\Lambda_{ab}\Lambda_{bb}^{-1}\Lambda_{ba}$ 의 역행렬</ul><p>$\Rightarrow$ $(\Lambda_{aa}-\Lambda_{ab}\Lambda_{bb}^{-1}\Lambda_{ba})^{-1} = \Sigma_{a}$</p><ul><li>일차식 계수 = $\Sigma^{-1}\mu$ 와 같았다.</ul><p>위에 식에서 일차식 계수는 $(\Lambda_{aa}-\Lambda_{ab}\Lambda_{bb}^{-1}\Lambda_{ba})\mu_{a}$ 이었다.</p><p>$\Sigma^{-1}\mu = [(\Lambda_{aa}-\Lambda_{ab}\Lambda_{bb}^{-1}\Lambda_{ba})\mu_{a}]$ 라고 두고 풀면</p><p>$\mu = \mu_{a}$ 가 된다.</p><ul><li>결국<li>$\Sigma_{a} = (\Lambda_{aa}- \Lambda_{ab}\Lambda_{bb}^{-1}\Lambda_{ba})^{-1}$<li>$\mu_{a} = \mu_{a}$</ul><p>가 된다.</p><hr /><h1 id="한편-1">한편</h1><ul><li><p>$[[\Lambda_{aa}, \Lambda_{ab}],[\Lambda_{ba},\Lambda_{bb}]]^{-1} = [[\Sigma_{aa},\Sigma_{ab}],[\Sigma_{ba},\Sigma_{bb}]]$ 였다.</p><li><p>$[[A,B],[C,D]]^{-1} = [[M, -MBD^{-1}],[-D^{-1}CM, D^{-1}CMBD^{-1]}]$ 을 이용해서 식을 전개해 보자.</p><li><p>$(\Lambda_{aa}-\Lambda_{ab}\Lambda_{bb}^{-1}\Lambda_{ba})^{-1} = \Sigma_{aa}$ 가 나온다.</p><li>정리하면 다음과 같다.<li>$E[X_{a}] = \mu_{a}$<li>$COV[X_{a}] = \Sigma_{aa}$</ul><p>직관적으로 매우 타당한 식이 결과로 나왔다.</p><hr /><h1 id="정리-및-요약">정리 및 요약</h1><h2 id="다변수정규분포-따르는-어떤-결합분포가-다음과-같을-때"><span class="mr-2">다변수정규분포 따르는 어떤 결합분포가 다음과 같을 때</span><a href="#다변수정규분포-따르는-어떤-결합분포가-다음과-같을-때" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>$X = [X_{a}, X_{b}]$<li>$\mu = [\mu_{a}, \mu_{b}]$<li>$\Sigma = [[\Sigma_{aa},\Sigma_{ab}],[\Sigma_{ba},\Sigma_{bb}]]$<li>$\Lambda = [[\Lambda_{aa},\Lambda_{ab}],[\Lambda_{ba}, \Lambda_{bb}]]$</ul><h2 id="--조건부-확률분포"><span class="mr-2">- 조건부 확률분포</span><a href="#--조건부-확률분포" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>$p(X_{a} \vert X_{b}) = N(X_{a} \vert \mu_{a \vert b}, \Lambda_{aa}^{-1})$</ul><h2 id="--주변확률분포"><span class="mr-2">- 주변확률분포</span><a href="#--주변확률분포" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>$p(X_{a}) = N(X_{a} \vert \mu_{a}, \Sigma_{aa})$</ul><h2 id="모두-다변수정규분포-따른다"><span class="mr-2">모두 다변수정규분포 따른다.</span><a href="#모두-다변수정규분포-따른다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h1 id="862-연습문제">8.6.2 연습문제</h1><p>문제</p><p>2차원 다변수정규분포가 다음과 같은 모수를 가진다고 하자.</p><p>$\mu = [\mu_{1}, \mu_{2}]$,</p><p>$\Sigma = [[\sigma_{1}^{2}, p\sigma_{1}\sigma_{2}],[p\sigma_{1}\sigma_{2}, \sigma_{2}^{2}]]$</p><p>$x_{2}$가 주어졌을 때 $x_{1}$ 의 조건부확률분포함수가 다음과 같음을 보여라.</p><ul><li>$N(x_{1} \vert \mu_{1}+(p\sigma_{1}\sigma_{2}/\sigma_{2}^{2})(x_{2}-\mu_{2}), \sigma_{1}^{2} - ((p\sigma_{1}\sigma_{2})^{2}/\sigma_{2}^{2}))$</ul><hr /><h1 id="내-풀이">내 풀이</h1><ul><li><p>$\mu = [[\mu_{1}], [\mu_{2}]]$</p><li>$\Sigma = [[\Sigma_{11},\Sigma_{12}],[\Sigma_{21},\Sigma_{22}]]$<li><p>$\Lambda = [[\Lambda_{11},\Lambda_{12}],[\Lambda_{21}, \Lambda_{22}]] = (\Sigma^{-1})$</p><li>$p(x_{1} \vert x_{2})$ 는 $N(x_{1} \vert \mu_{1 \vert 2}, \Sigma_{1 \vert 2})$ 따른다</ul><p>$\Rightarrow$ $-(1/2)(x-\mu)^{T}\Sigma^{-1}(x-\mu) =$</p><p>$-(1/2)x^{T}\Sigma^{-1}x+x^{T}\Sigma^{-1}\mu + const$</p><p>지수의 이차형식에 $x$, $\mu$ 넣어서 전개한 다음 이차형식 형태로 정리되는지 보자.</p><p>정리하면 다음과 같다. (계산과정 생략)</p><p>$-(1/2)x_{1}^{T}\Lambda_{11}x_{1}$</p><p>$+ (-(1/2)\Lambda_{21}x_{2} - (1/2)\Lambda_{12}x_{2}+\Lambda_{11}\mu_{11}+\Lambda_{12}\mu_{2})x_{1}$</p><p>$+ (-(1/2)\Lambda_{22}x_{2}^{2} + \Lambda_{21}x_{2}\mu_{1} + \Lambda_{22}x_{2}\mu_{2}+ const)$</p><ul><li>$\Lambda_{11} = \Sigma^{-1}$<li><p>$\Lambda_{11}^{-1} = \Sigma_{a \vert b}$</p><li>$\Sigma^{-1}\mu = (-(1/2)\Lambda_{21}x_{2}-(1/2)\Lambda_{12}x_{2}+\Lambda_{11}\mu_{1} + \Lambda_{12}\mu_{12})$<li><p>$\Sigma*\Sigma^{-1}\mu = \Sigma(-\Lambda_{21}x_{2} + \Lambda_{11}\mu_{1}+\Lambda_{12}\mu_{2})$</p><li>$\mu_{a \vert b} = \Lambda_{11}^{-1}(-\Lambda_{21}x_{2}+\Lambda_{11}\mu_{1}+\Lambda_{12}\mu_{2})$</ul><hr /><p>$[[\Sigma_{11}, \Sigma_{12}],[\Sigma_{21},\Sigma_{22}]]^{-1} = [[\Lambda_{11},\Lambda_{12}],[\Lambda_{21}, \Lambda_{22}]]$</p><p>를 이용하자. (구체적인 식은 앞에 참고)</p><p><img width="1222" alt="Screen Shot 2021-07-25 at 18 14 05" data-src="https://user-images.githubusercontent.com/83487073/126894026-f4b023fc-7597-49c1-a45e-218484b5d90d.png" data-proofer-ignore></p><ul><li>$\Lambda_{11} = (\Sigma_{11}-\Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21})^{-1}$<li><p>$\Lambda_{12} = -(\Sigma_{11}-\Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21})^{-1}\Sigma_{12}\Sigma_{22}^{-1}$</p><li>$\Sigma_{a \vert b} = \Lambda_{11}^{-1}$<li>$\mu_{a \vert b} = \Lambda_{11}^{-1}(-\Lambda_{21}x_{2}+\Lambda_{11}\mu_{1}+\Lambda_{12}\mu_{2})$</ul><p>= $-\Lambda_{11}^{-1}\Lambda_{21}x_{2}+\mu_{1}+\Lambda_{11}^{-1}\Lambda_{12}\mu_{2}$</p><p>= $\mu_{a \vert b} = \mu_{1} + (\Lambda_{11}^{-1}\Lambda_{12})(\mu_{2}-x_{2})$</p><ul><li><p>앞에서 구한 $\Lambda_{11}$ 과 $\Lambda_{12}$ 을 이용해서 $\Sigma_{a \vert b}$, $\mu_{a \vert b}$ 식을 바꾸면 다음과 같다.</p><li>$\mu_{a \vert b} = \mu_{1}+\Sigma_{12}\Sigma_{22}^{-1}(x_{2}, \mu_{2})$<li>$\Sigma_{a \vert b} = \Sigma_{11}-\Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21}$</ul><hr /><p>앞에서</p><p>$\Sigma$</p><p>$= [[\sigma_{1}^{2}, p\sigma_{1}\sigma_{2}],[p\sigma_{1}\sigma_{2}, \sigma_{2}^{2}]]$</p><p>$= [[\Sigma_{11},\Sigma_{12}],[\Sigma_{21}, \Sigma_{22}]]$</p><p>였다.</p><p>$\mu_{a \vert b}$, $\Sigma_{a \vert b}$ 에 대입해서 식 정리하면</p><ul><li><p>$\mu_{a \vert b} = \mu_{1} + ((p\sigma_{1}\sigma_{2})/\sigma_{2}^{2})$ $(x_{2}-\mu_{2})$</p><li><p>$\Sigma_{a \vert b} = \sigma_{1}^{2}-(p\sigma_{1}\sigma_{2})^{2}/\sigma_{2}^{2}$</p></ul><p>로, 증명이 완료된다.</p><hr /><p>위 내용을 공부 &amp; 정리 하면서 참조한 곳 : http://norman3.github.io/prml/docs/chapter02/3_1.html</p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/bioinfo.github.io/categories/data-science/'>Data Science</a>, <a href='/bioinfo.github.io/categories/python/'>python</a>, <a href='/bioinfo.github.io/categories/mathematics/'>mathematics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/bioinfo.github.io/tags/mathematics/" class="post-tag no-text-decoration" >mathematics</a> <a href="/bioinfo.github.io/tags/study/" class="post-tag no-text-decoration" >study</a> <a href="/bioinfo.github.io/tags/data-science/" class="post-tag no-text-decoration" >data science</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5B%EC%88%98%ED%95%99%2F%ED%99%95%EB%A5%A0%EA%B3%BC+%ED%86%B5%EA%B3%84%5D+F%EB%B6%84%ED%8F%AC%2C+%EB%8B%A4%EB%B3%80%EC%88%98%EC%A0%95%EA%B7%9C%EB%B6%84%ED%8F%AC%28%EC%A1%B0%EA%B1%B4%EB%B6%80%EB%B6%84%ED%8F%AC%2C+%EC%A3%BC%EB%B3%80%EB%B6%84%ED%8F%AC+%ED%8F%AC%ED%95%A8%29+-+der+Wille+zur+Macht&url=https%3A%2F%2Ftigerkey10.github.io%2Fbioinfo.github.io%2Fposts%2FF_distribution_and_others%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5B%EC%88%98%ED%95%99%2F%ED%99%95%EB%A5%A0%EA%B3%BC+%ED%86%B5%EA%B3%84%5D+F%EB%B6%84%ED%8F%AC%2C+%EB%8B%A4%EB%B3%80%EC%88%98%EC%A0%95%EA%B7%9C%EB%B6%84%ED%8F%AC%28%EC%A1%B0%EA%B1%B4%EB%B6%80%EB%B6%84%ED%8F%AC%2C+%EC%A3%BC%EB%B3%80%EB%B6%84%ED%8F%AC+%ED%8F%AC%ED%95%A8%29+-+der+Wille+zur+Macht&u=https%3A%2F%2Ftigerkey10.github.io%2Fbioinfo.github.io%2Fposts%2FF_distribution_and_others%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftigerkey10.github.io%2Fbioinfo.github.io%2Fposts%2FF_distribution_and_others%2F&text=%5B%EC%88%98%ED%95%99%2F%ED%99%95%EB%A5%A0%EA%B3%BC+%ED%86%B5%EA%B3%84%5D+F%EB%B6%84%ED%8F%AC%2C+%EB%8B%A4%EB%B3%80%EC%88%98%EC%A0%95%EA%B7%9C%EB%B6%84%ED%8F%AC%28%EC%A1%B0%EA%B1%B4%EB%B6%80%EB%B6%84%ED%8F%AC%2C+%EC%A3%BC%EB%B3%80%EB%B6%84%ED%8F%AC+%ED%8F%AC%ED%95%A8%29+-+der+Wille+zur+Macht" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="tigerkey10/bioinfo.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/bioinfo.github.io/posts/logical_writing1/">[Logical Writing Study 01] Subject : Should Generative A.I. Be Regulated by Law?</a><li><a href="/bioinfo.github.io/posts/classifier/">[알고리즘/지도학습] 로지스틱 회귀, 서포트벡터 머신, 나이브 베이즈 알고리듬, 분류모형 별 성능 비교</a><li><a href="/bioinfo.github.io/posts/regressor/">[알고리즘/지도학습] 회귀문제 - 선형회귀, 의사결정회귀나무, 의사결정회귀나무 앙상블(그래디언트 부스트)</a><li><a href="/bioinfo.github.io/posts/boosting/">[알고리즘/지도학습] 앙상블 알고리즘-부스팅(에이다 부스트, 그래디언트 부스트)</a><li><a href="/bioinfo.github.io/posts/ensemble/">[알고리즘/지도학습] 앙상블 알고리즘-취합(다수결 투표, 배깅, 랜덤포레스트)</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/bioinfo.github.io/tags/study/">study</a> <a class="post-tag" href="/bioinfo.github.io/tags/python/">python</a> <a class="post-tag" href="/bioinfo.github.io/tags/mathematics/">mathematics</a> <a class="post-tag" href="/bioinfo.github.io/tags/data-science/">data science</a> <a class="post-tag" href="/bioinfo.github.io/tags/computer-science/">computer science</a> <a class="post-tag" href="/bioinfo.github.io/tags/datascience/">datascience</a> <a class="post-tag" href="/bioinfo.github.io/tags/data-structure/">data structure</a> <a class="post-tag" href="/bioinfo.github.io/tags/algorithm/">algorithm</a> <a class="post-tag" href="/bioinfo.github.io/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/bioinfo.github.io/tags/ml/">ML</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/bioinfo.github.io/posts/percentage_recap2/"><div class="card-body"> <em class="small" data-ts="1624374000" data-df="YYYY-MM-DD" > 2021-06-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률론] 결합확률과 조건부확률, 결합확률분포 정의내리기- 확률론 기초 복습 (2)</h3><div class="text-muted small"><p> 2021-6월-23일 &amp;lt;6장 확률론 복습 -2 &amp;gt; 확률밀도함수 확률값과 똑같은 성질 갖는다. 확률밀도함숫값 p(x)는 항상 0 이상이다. -무한대~+무한대 구간 확률밀도함수 면적 구하면 1이다. 결합확률 P(A,B) or P(AnB) 사건 A,B가 동시에 발생할 확률 결합확률 P(A,B) or P(AnB) 사건...</p></div></div></a></div><div class="card"> <a href="/bioinfo.github.io/posts/random_variable/"><div class="card-body"> <em class="small" data-ts="1624719600" data-df="YYYY-MM-DD" > 2021-06-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률과 통계] 확률변수, 확률분포 모멘트</h3><div class="text-muted small"><p> 2021-06-27 7. 확률변수, 확률변수 모멘트 복습 확률변수 변환 기존 확률변수 이용해서 새 확률변수 만드는 것. 통계량 특정 표본값 전부를 하나의 공식에 넣어서 구해낸 하나의 값 큰 수의 법칙 표본평균 확률변수 기댓값은 원래 확률변수 기댓값과 같다. $E[\bar{X}] = E[X]$ $\Rightarrow$ 표본평균은 모평...</p></div></div></a></div><div class="card"> <a href="/bioinfo.github.io/posts/normal_distribution/"><div class="card-body"> <em class="small" data-ts="1626793200" data-df="YYYY-MM-DD" > 2021-07-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률과 통계] 스튜던트 t분포, 카이제곱분포</h3><div class="text-muted small"><p> t분포 (스튜던트 t분포) : t통계량 분포 팻테일 현상 보이는 데이터에 적용하기 좋은 확률분포다. (예: 주식 일간수익률 데이터) 기댓값, 정밀도, 자유도를 모수로 갖는다. 자유도는 2이상의 자연수를 쓴다. 형상은 정규분포와 비슷하다. 자유도 = 1 인 t분포는 ‘코시분포’라고 부른다. t통계량의 분포다. t통계량 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/bioinfo.github.io/posts/normal_distribution/" class="btn btn-outline-primary" prompt="이전 글"><p>[수학/확률과 통계] 스튜던트 t분포, 카이제곱분포</p></a> <a href="/bioinfo.github.io/posts/betta_gamma_diliclet_distribution/" class="btn btn-outline-primary" prompt="다음 글"><p>[수학/확률과 통계] 베타, 감마, 디리클레분포</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a>.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/bioinfo.github.io/tags/study/">study</a> <a class="post-tag" href="/bioinfo.github.io/tags/python/">python</a> <a class="post-tag" href="/bioinfo.github.io/tags/mathematics/">mathematics</a> <a class="post-tag" href="/bioinfo.github.io/tags/data-science/">data science</a> <a class="post-tag" href="/bioinfo.github.io/tags/computer-science/">computer science</a> <a class="post-tag" href="/bioinfo.github.io/tags/datascience/">datascience</a> <a class="post-tag" href="/bioinfo.github.io/tags/data-structure/">data structure</a> <a class="post-tag" href="/bioinfo.github.io/tags/algorithm/">algorithm</a> <a class="post-tag" href="/bioinfo.github.io/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/bioinfo.github.io/tags/ml/">ML</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/bioinfo.github.io/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/bioinfo.github.io/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/bioinfo.github.io/app.js"></script>
