<!DOCTYPE html><html lang="ko-KR" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[수학/최적화] 전역 최적화, 컨벡스 최적화, 제한조건 최적화" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="공부 중인 내용을 정리한 글" /><meta property="og:description" content="공부 중인 내용을 정리한 글" /><link rel="canonical" href="https://tigerkey10.github.io/bioinfo.github.io/posts/global_convex_optimization/" /><meta property="og:url" content="https://tigerkey10.github.io/bioinfo.github.io/posts/global_convex_optimization/" /><meta property="og:site_name" content="der Wille zur Macht" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-08T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[수학/최적화] 전역 최적화, 컨벡스 최적화, 제한조건 최적화" /><meta name="google-site-verification" content="1CLBUlwAX10LXrW4RzkPuaeWtey34c3dyngs14cKrCw" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-09-09T00:00:00+09:00","datePublished":"2021-09-08T00:00:00+09:00","description":"공부 중인 내용을 정리한 글","headline":"[수학/최적화] 전역 최적화, 컨벡스 최적화, 제한조건 최적화","mainEntityOfPage":{"@type":"WebPage","@id":"https://tigerkey10.github.io/bioinfo.github.io/posts/global_convex_optimization/"},"url":"https://tigerkey10.github.io/bioinfo.github.io/posts/global_convex_optimization/"}</script><title>[수학/최적화] 전역 최적화, 컨벡스 최적화, 제한조건 최적화 | der Wille zur Macht</title><link rel="apple-touch-icon" sizes="180x180" href="/bioinfo.github.io/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/bioinfo.github.io/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/bioinfo.github.io/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/bioinfo.github.io/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/bioinfo.github.io/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="der Wille zur Macht"><meta name="application-name" content="der Wille zur Macht"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/bioinfo.github.io/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/bioinfo.github.io/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'] ], processEscapes: true, } }); MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/bioinfo.github.io/" class="mx-auto"> <img src="/bioinfo.github.io/assets/img/emoge.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/bioinfo.github.io/">der Wille zur Macht</a></div><div class="site-subtitle font-italic">10,000 Hours</div></div><ul class="w-100"><li class="nav-item"> <a href="/bioinfo.github.io/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/bioinfo.github.io/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/bioinfo.github.io/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/bioinfo.github.io/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>타임라인</span> </a><li class="nav-item"> <a href="/bioinfo.github.io/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="https://github.com/tigerkey10" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kkb1004tom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/bioinfo.github.io/"> Home </a> </span> <span>[수학/최적화] 전역 최적화, 컨벡스 최적화, 제한조건 최적화</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[수학/최적화] 전역 최적화, 컨벡스 최적화, 제한조건 최적화</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1631026800" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2021-09-08 </em> </span> <span> 업데이트 <em class="" data-ts="1631145600" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2021-09-09 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="9023 단어"> <em>50 분</em>읽는 시간</span></div></div></div><div class="post-content"><h1 id="전역-최적화-문제">전역 최적화 문제</h1><h2 id="정의-"><span class="mr-2">정의 :</span><a href="#정의-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>최적화를 통해 함수 전역 최저점을 찾는 문제</p><hr /><p>내가 어떤 최적화 결과를 얻었는데, 그 최적점이 함수 전역의 최적점이라고 확신할 수 있는가?</p><p>만약 함수형태가 컨벡스함수(볼록함수) 라면, 함수 전역 최저점이라고 생각할 수 있을 것이다.</p><p>반면에 함수가 전역 최저점 말고도 여러 개의 국소 최저점을 갖고 있다면?</p><p>내가 얻은 최적화 결과가 전역 최저점이라고 단정지어 말하기 어렵다.</p><h2 id="곧-함수에-여러-개의-국소-최저점이-존재하는-경우-스텝사이즈-나-최적화-시작-위치-등에-따라"><span class="mr-2">곧, 함수에 여러 개의 국소 최저점이 존재하는 경우. 스텝사이즈 나 최적화 시작 위치 등에 따라</span><a href="#곧-함수에-여러-개의-국소-최저점이-존재하는-경우-스텝사이즈-나-최적화-시작-위치-등에-따라" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="최적화-결과가-전역-최저점이-아닌-국소-최저점-일-수-있다"><span class="mr-2">최적화 결과가 전역 최저점이 아닌 국소 최저점 일 수 있다.</span><a href="#최적화-결과가-전역-최저점이-아닌-국소-최저점-일-수-있다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p>최적화 결과가 전역이 아닌 국소 최저점에 수렴한 예)</p><p><img width="657" alt="Screen Shot 2021-09-08 at 9 10 32" data-src="https://user-images.githubusercontent.com/83487073/132425391-ca8124a0-22e3-4be5-b1b2-67ac2150abe3.png" data-proofer-ignore></p><p>나는 이 목적함수를 대상으로 전역 최적화 문제를 풀고 싶다.</p><p>함수 가장 아래쪽 ‘글로벌 최저점’에 수렴하는 게 목표다.</p><h2 id="비선형-목적함수-최적화--최대경사법-알고리듬-사용"><span class="mr-2">비선형 목적함수 최적화 : 최대경사법 알고리듬 사용</span><a href="#비선형-목적함수-최적화--최대경사법-알고리듬-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="c1"># 위 비선형 목적함수 직접 최적화 해보자. 
# 최대경사법 
</span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">'x'</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">sympy</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sympy</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f_non_linear</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="c1"># 최적화 시작점
</span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.5</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">gradient</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'ro'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="s">'로컬 최저점에 수렴'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'비선형 목적함수 최대경사법 최적화'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.003</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'시작점 : [-7.5, </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">f_non_linear</span><span class="p">(</span><span class="mf">7.5</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">], 결과 : 왼쪽 로컬 최저점 수렴'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$y$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="658" alt="Screen Shot 2021-09-08 at 9 12 00" data-src="https://user-images.githubusercontent.com/83487073/132425488-e1bf16bf-da44-4009-8cbf-d5e6ce0cd0b9.png" data-proofer-ignore></p><p>$[-7.5, 49.32]$ 에서 시작한 결과 전역 최저점이 아닌 왼쪽 로컬 최저점에 수렴했다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="c1"># 최적화 시작점
</span><span class="n">a</span> <span class="o">=</span> <span class="mf">7.5</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">gradient</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'ro'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="s">'로컬 최저점에 수렴'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'비선형 목적함수 최대경사법 최적화'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.003</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'시작점 : [7.5, </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">f_non_linear</span><span class="p">(</span><span class="mf">7.5</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">], 결과 : 오른쪽 로컬 최저점 수렴'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$y$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="656" alt="Screen Shot 2021-09-08 at 9 12 59" data-src="https://user-images.githubusercontent.com/83487073/132425549-87f6acc0-51c7-476e-a032-f0ae0107765c.png" data-proofer-ignore></p><p>같은 최대경사법 알고리듬으로, 시작점 $[7.5, 49.32]$ 에서 최적화를 시작해봤다.</p><p>결과는 오른쪽 로컬 최저점에 수렴했다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="c1"># 최적화 시작점
</span><span class="n">a</span> <span class="o">=</span> <span class="mf">2.5</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">gradient</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'ro'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="s">'글로벌 최저점에 수렴'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'비선형 목적함수 최대경사법 최적화'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.003</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'시작점 : [</span><span class="si">{</span><span class="mf">2.5</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">f_non_linear</span><span class="p">(</span><span class="mf">2.5</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">], 결과 : 글로벌 최저점 수렴'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$y$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="654" alt="Screen Shot 2021-09-08 at 9 14 04" data-src="https://user-images.githubusercontent.com/83487073/132425612-4bace6ee-20bb-4a6e-8dfb-874ded29b36e.png" data-proofer-ignore></p><p>한편 시작점을 $[2.5, 22.27]$ 로 잡았을 때는 최적화 결과가 전역 최저점에 수렴했다.</p><p>이처럼, 함수에 여러 개의 국소 최저점이 있는 경우.</p><p>시작점이 어디냐에 따라 최적화 결과가 전역 최저점에 수렴하지 않을 수 있었다.</p><h2 id="비선형-목적함수-최적화--뉴턴방법-알고리듬-사용"><span class="mr-2">비선형 목적함수 최적화 : 뉴턴방법 알고리듬 사용</span><a href="#비선형-목적함수-최적화--뉴턴방법-알고리듬-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="c1"># 뉴턴방법 
</span><span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'시작점 : </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">g</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>


<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'시작점 : </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">g</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'시작점 : </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">g</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>
<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'뉴턴 : 비선형함수 모양이 2차함수 모양과 다르고, 로컬최저점이 많아서 제대로 최적화 안 된다'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.03</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="653" alt="Screen Shot 2021-09-08 at 9 16 34" data-src="https://user-images.githubusercontent.com/83487073/132425756-e6f992f2-4e49-4e9b-a049-c61f3d9a1cc4.png" data-proofer-ignore></p><h2 id="비선형-목적함수-최적화--준-뉴턴방법bfgs"><span class="mr-2">비선형 목적함수 최적화 : 준 뉴턴방법(BFGS)</span><a href="#비선형-목적함수-최적화--준-뉴턴방법bfgs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">sp</span><span class="p">.</span><span class="n">optimize</span><span class="p">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f_non_linear</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="530" alt="Screen Shot 2021-09-08 at 9 17 34" data-src="https://user-images.githubusercontent.com/83487073/132425814-2aa5b66d-15bb-4d19-b9eb-1ee91d1371eb.png" data-proofer-ignore></p><hr /><h1 id="컨벡스-최적화">컨벡스 최적화</h1><h2 id="정의--1"><span class="mr-2">정의 :</span><a href="#정의--1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>컨벡스 함수를 대상으로 최적화(최소화) 하는 방법</p><ul><li>컨벡스 최적화 결과는 항상 전역 최적해다.</ul><h2 id="컨벡스-필요조건-"><span class="mr-2">컨벡스 필요조건 :</span><a href="#컨벡스-필요조건-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>DCP rule</ul><p>컨벡스 필요조건을 DCP rule 이라고 한다.</p><p>목적함수가 DCP rule 을 만족하면, 그 함수는 무조건 컨벡스 함수다.</p><p>하지만 컨벡스 함수인데 DCP rule 만족하지 않는 경우도 왕왕 있다.</p><p>DCP rule $\rightarrow$ $Convex$</p><p>$Convex$ $\nrightarrow$ DCP rule</p><hr /><h2 id="함수가-dcp-rule-을-만족하지-않지만-컨벡스-함수인-예"><span class="mr-2">함수가 DCP rule 을 만족하지 않지만, 컨벡스 함수인 예</span><a href="#함수가-dcp-rule-을-만족하지-않지만-컨벡스-함수인-예" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>목적함수 : $2x_{1}^{2} +x_{2}^{2}+x_{1}x_{2}+x_{1}+x_{2}$</p><p>제한조건 :</p><p>$x_{1} + x_{2} = 1$</p><p>$x_{1} \ge 0$</p><p>$x_{2} \ge 0$</p><p>위 목적함수, 그리고 제한조건을 고려한 목적함수의 최소화 문제도 DCP rule 을 만족하지 않는다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1"># 목적함수가 DCP rule 만족하지 않는다
</span><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="n">cp</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>

<span class="n">obj</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="o">+</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span>
<span class="n">obj</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="275" alt="Screen Shot 2021-09-09 at 18 20 15" data-src="https://user-images.githubusercontent.com/83487073/132659420-97ce605d-ff54-4c11-8b65-ca466b19fffb.png" data-proofer-ignore></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># 최소화 문제도 DCP rule 만족하지 않는다
</span><span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="n">cons</span> <span class="o">=</span> <span class="p">[</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">cons</span><span class="p">)</span>
<span class="n">prob</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="275" alt="Screen Shot 2021-09-09 at 18 20 15" data-src="https://user-images.githubusercontent.com/83487073/132659420-97ce605d-ff54-4c11-8b65-ca466b19fffb.png" data-proofer-ignore></p><p>하지만, 이 함수를 그려보면</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="n">y</span> 
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">'3d'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'flare'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'컨벡스 함수지만 DCP rule 만족하지 않는 것들도 있다'</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="656" alt="Screen Shot 2021-09-09 at 18 23 44" data-src="https://user-images.githubusercontent.com/83487073/132660004-7ce1a8c0-c9df-4cbc-b794-3e3a1c301401.png" data-proofer-ignore></p><p>모양이 아래에서 봤을 때 볼록한, 컨벡스 함수임을 확인할 수 있다.</p><p>따라서 어떤 함수가 DCP rule 에 어긋나지만. 컨벡스 함수인 경우도 존재한다.</p><p>(위 예시의 함수는 이차계획법 문제로 고쳐서 CVXOPT 의 solver.qp 명령으로 컨벡스 최적화 할 수 있다)</p><p>(DCP rule에 대해서는 아래 CVXPY 부분에 좀 더 자세하게 기록해두었다)</p><hr /><h2 id="컨케이브오목-함수-최대화도-컨벡스-최적화에-포함된다"><span class="mr-2">컨케이브(오목) 함수 최대화도 컨벡스 최적화에 포함된다</span><a href="#컨케이브오목-함수-최대화도-컨벡스-최적화에-포함된다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>컨벡스 최적화는 컨벡스 함수를 대상으로 최소화 하는 작업으로 정의된다.</p><p>그런데 컨케이브 함수 최대화도 컨벡스 최적화로 볼 수 있다.</p><p>컨케이브 함수를 반대로 뒤집으면 컨벡스 함수와 같다.</p><p>그리고 컨케이브 함수의 최대점은 이 함수를 반대로 뒤집은 컨벡스 함수의 최소점과 같다.</p><p>$\Rightarrow$ 컨케이브 함수 최대화 문제와 컨벡스 함수 최소화 문제 둘 중 하나를 풀 수 있으면 나머지 하나도 반드시 풀 수 있다.</p><p>결국 컨케이브 함수 최대화 문제를 푸는 건 컨벡스 함수 최소화 문제 푸는 것과 같다.</p><h2 id="rightarrow-컨케이브-함수-최대화-문제를-푸는-것--컨벡스-최적화-문제"><span class="mr-2">$\Rightarrow$ 컨케이브 함수 최대화 문제를 푸는 것 $=$ 컨벡스 최적화 문제</span><a href="#rightarrow-컨케이브-함수-최대화-문제를-푸는-것--컨벡스-최적화-문제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>따라서 컨케이브 함수 최대화도 컨벡스 최적화에 포함되는 개념이다.</p><h2 id="maximizeconcave-minimizeconvex-subset-convex-optimization"><span class="mr-2">$Maximize(concave), Minimize(convex) \subset$ $Convex$ $Optimization$</span><a href="#maximizeconcave-minimizeconvex-subset-convex-optimization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="한편"><span class="mr-2">한편</span><a href="#한편" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>대부분의 경우 최적화 할 때 최소화 문제만을 고려한다. 최소화 문제를 풀 수 있으면 최대화 문제도 풀 수 있다.</p><p>그러면 사실상 컨벡스 최적화 문제 $= Minimize(Convex)$ 를 의미한다고 볼 수 있다.</p><h2 id="그래서-컨벡스-최적화를-다음과-같이-정의하기도-한다"><span class="mr-2">그래서 컨벡스 최적화를 다음과 같이 정의하기도 한다.</span><a href="#그래서-컨벡스-최적화를-다음과-같이-정의하기도-한다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="fracd2hdx2-ge-0"><span class="mr-2">$\frac{d^{2}h}{dx^{2}} \ge 0$</span><a href="#fracd2hdx2-ge-0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>‘목적함수의 2차 도함수가 0 이상인 구간 에서만 정의된 최적화(최소화)’</p><p>다변수함수의 경우</p><h2 id="xthx-ge-0"><span class="mr-2">$x^{T}Hx \ge 0$</span><a href="#xthx-ge-0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>‘목적함수의 헤시안 행렬(2차 도함수 행렬)이 양의 준정부호인 영역 에서만 정의된 최적화(최소화)’</p><h2 id="즉-목적함수-h의-볼록구간영역에서만-정의된-최적화최소화라는-것이다"><span class="mr-2">즉, 목적함수 $h$의 볼록구간(영역)에서만 정의된 최적화(최소화)라는 것이다.</span><a href="#즉-목적함수-h의-볼록구간영역에서만-정의된-최적화최소화라는-것이다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h1 id="전역-최적화-문제를-푸는-도구로서의-컨벡스-최적화">전역 최적화 문제를 푸는 도구로서의 컨벡스 최적화</h1><h2 id="-목적함수가-전역-최저점-뿐-아니라-국소-최저점이-여러-개-있는-경우"><span class="mr-2"># 목적함수가 전역 최저점 뿐 아니라, 국소 최저점이 여러 개 있는 경우</span><a href="#-목적함수가-전역-최저점-뿐-아니라-국소-최저점이-여러-개-있는-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>위에서 봤던 비선형 목적함수를 다시 보자.</p><p><img width="658" alt="Screen Shot 2021-09-08 at 9 24 47" data-src="https://user-images.githubusercontent.com/83487073/132426294-7fe06138-9fcd-4ed4-8cb4-98990901cd2d.png" data-proofer-ignore></p><p>국소최저점이 많아서 전역 최적화에 실패했었다.</p><p>이 함수의 각 볼록구간만 잘라서, 각각 최적화 하는 것은 컨벡스 최적화를 3번 하는 것과 같다.</p><p>우선 위 비선형 목적함수에서 2차도함숫값이 항상 0 이상인 구간만 구해보자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f_non_linear</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">'x'</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">sympy</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">fprime</span> <span class="o">=</span> <span class="n">sympy</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">sympy</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fprime</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="n">h</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="s">'ro-'</span><span class="p">)</span>

<span class="n">first_convex</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">4</span><span class="p">]</span>
<span class="n">second_convex</span> <span class="o">=</span> <span class="n">result</span><span class="p">[(</span><span class="n">result</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">third_convex</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">]</span>
</pre></table></code></div></div><p><img width="656" alt="Screen Shot 2021-09-08 at 9 29 28" data-src="https://user-images.githubusercontent.com/83487073/132426654-0474d47e-3b39-4b90-96cf-473e7573d6c9.png" data-proofer-ignore></p><p>빨간색 점으로 표현된 3개 구간이 2차 도함수가 항상 0 이상인 컨벡스 구간이다.</p><p>각 구간별로 컨벡스 최적화해보자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># 구간1
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">first_convex</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">first_convex</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'2차 도함수 &gt;= 0 인 첫번째 컨벡스 구간(볼록구간)'</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="c1"># 최적화 시작점
</span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.5</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">gradient</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'컨벡스 구간 1의 최소점 : </span><span class="si">{</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'컨벡스 구간 1의 최적해 : </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="657" alt="Screen Shot 2021-09-08 at 9 31 00" data-src="https://user-images.githubusercontent.com/83487073/132426756-2c4ebbd5-c71e-4a45-bed8-2fba64794b3e.png" data-proofer-ignore></p><p>구간 1 최소점 : 15.79</p><p>구간 1 최적해 : -5.67</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># 구간2
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">second_convex</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">second_convex</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'2차 도함수 &gt;= 0 인 두번째 컨벡스 구간(볼록구간)'</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.06</span>
<span class="c1"># 최적화 시작점
</span><span class="n">a</span> <span class="o">=</span> <span class="n">second_convex</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">gradient</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'컨벡스 구간 2의 최소점 : </span><span class="si">{</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'컨벡스 구간 2의 최적해 : </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="655" alt="Screen Shot 2021-09-08 at 9 31 59" data-src="https://user-images.githubusercontent.com/83487073/132426837-686a8de7-f369-4db5-be7e-5b645114aa3f.png" data-proofer-ignore></p><p>구간 2 최소점 : -19.99</p><p>구간 2 최적해 : -4.512</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># 구간3
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">third_convex</span><span class="p">,</span> <span class="n">f_non_linear</span><span class="p">(</span><span class="n">third_convex</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'2차 도함수 &gt;= 0 인 세번째 컨벡스 구간(볼록구간)'</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.06</span>
<span class="c1"># 최적화 시작점
</span><span class="n">a</span> <span class="o">=</span> <span class="n">third_convex</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="s">'go'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">next_</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">gradient</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">next_</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'컨벡스 구간 3의 최소점 : </span><span class="si">{</span><span class="n">f_non_linear</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'컨벡스 구간 3의 최적해 : </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="655" alt="Screen Shot 2021-09-08 at 9 33 03" data-src="https://user-images.githubusercontent.com/83487073/132426921-26bf19bc-edf5-4b0c-9a36-693573e550dd.png" data-proofer-ignore></p><p>구간 3 최소점 : 15.79</p><p>구간 3 최적해 : 5.67</p><p>이렇게 각각 컨벡스 구간별로 컨벡스 최적화를 3번 할 수 있다.</p><p>한편, 컨벡스 최적화를 하면 각 구간 별 전역 최적해 값을 얻을 수 있다.</p><p>위 경우에도 구간 1~3의 전역 최적해 값을 얻을 수 있었다.</p><p>각 구간의 전역 최적해 값은 함수 전체로 보면 국소 최저점들일 수 있다.</p><p>이 국소 최저점들을 비교했을 때, 가장 작은 값이 전역 최적점이라고 볼 수 있다.</p><p>컨벡스 구간 2의 최소위치가 가장 출력값이 작으므로, 전역 최소점이라고 볼 수 있다.</p><p>$\Rightarrow$ 이렇게 전역 최적화가 어려운 비선형 목적함수를,</p><p>여러 컨벡스 구간으로 잘라서 컨벡스 최적화 한 다음</p><p>각 결과값을 비교해서 전역 최적점을 찾아낼 수도 있다.</p><h2 id="따라서-컨벡스-최적화는-전역-최적화-문제를-푸는-도구가-될-수-있다"><span class="mr-2">따라서 컨벡스 최적화는 전역 최적화 문제를 푸는 도구가 될 수 있다.</span><a href="#따라서-컨벡스-최적화는-전역-최적화-문제를-푸는-도구가-될-수-있다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h1 id="파이썬-패키지로-컨벡스-최적화-하기">파이썬 패키지로 컨벡스 최적화 하기</h1><h2 id="cvxpy"><span class="mr-2">CVXPY</span><a href="#cvxpy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="목적함수와-최적화-문제-모두-dcp-rule-을-만족해야-컨벡스-최적화-가능한-패키지"><span class="mr-2">목적함수와 최적화 문제 모두 DCP rule 을 만족해야 컨벡스 최적화 가능한 패키지.</span><a href="#목적함수와-최적화-문제-모두-dcp-rule-을-만족해야-컨벡스-최적화-가능한-패키지" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>목적함수가 비록 컨벡스(컨케이브) 함수라도 DCP rule 에 안 맞으면 최적화 못한다.<li>목적함수가 DCP rule 에 부합해도, 정의한 최적화 문제가 DCP rule 에 안 맞으면 최적화 못 한다.<li>직관적 심볼릭 연산 할 수 있다는 장점. 있다.</ul><h2 id="cvxopt"><span class="mr-2">CVXOPT</span><a href="#cvxopt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>solvers 객체를 이용해서 다양한 컨벡스 최적화가 가능하다.<li>주로 LP문제(선형계획법 문제), QP문제(이차계획법 문제) 해결을 위해 CVXOPT를 사용했다.</ul><hr /><h1 id="cvxpy-1">CVXPY</h1><h2 id="목적함수와-최적화-문제-모두-dcp-rule-을-만족해야-컨벡스-최적화-가능한-패키지-1"><span class="mr-2">목적함수와 최적화 문제 모두 DCP rule 을 만족해야 컨벡스 최적화 가능한 패키지.</span><a href="#목적함수와-최적화-문제-모두-dcp-rule-을-만족해야-컨벡스-최적화-가능한-패키지-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>(강조) 목적함수가 비록 컨벡스(컨케이브) 함수라도 DCP rule 에 안 맞으면 최적화 못한다.<li>(강조) 목적함수가 DCP rule 에 부합해도, 정의한 최적화 문제가 DCP rule 에 안 맞으면 최적화 못 한다.<li>컨벡스 최적화 할 때 등식/부등식 제한조건을 걸 수도 있다.</ul><hr /><h2 id="최적화-하려는-목적함수가-dcp-rule-만족하는지-보려면"><span class="mr-2">최적화 하려는 목적함수가 DCP rule 만족하는지 보려면</span><a href="#최적화-하려는-목적함수가-dcp-rule-만족하는지-보려면" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>object.curvature 명령 입력했을 때 CONVEX, CONCAVE, AFFINE, CONSTANT 로 나오는 목적함수들은 모두 DCP rule 만족하는 것들이다.</p><p>*Constant 와 Affine 은 Concave 이기도 하고 Convex 이기도 하다. 따라서 Constant 와 Affine 도 컨벡스 최적화 할 수 있다(컨벡스 함수다).</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">object</span><span class="p">.</span><span class="n">curvature</span>
</pre></table></code></div></div><hr /><h2 id="내가-정의한-최적화-문제가-dcp-rule-만족하는지-보려면"><span class="mr-2">내가 정의한 최적화 문제가 DCP rule 만족하는지 보려면</span><a href="#내가-정의한-최적화-문제가-dcp-rule-만족하는지-보려면" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># 목적함수 최대화, 최소화 명령이 dcp rule 만족하는가
</span><span class="nb">object</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">()</span>

<span class="c1"># 제한조건 반영한 최적화 문제가 dcp rule 만족하는가
</span><span class="n">prob</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">()</span>
</pre></table></code></div></div><p>*참고</p><p>컨벡스 함수를 최대화 하라고 한다던가, 컨케이브 함수를 최소화 하라고 한다던가,</p><p>혹은 목적함수에 제한조건을 적용했을 때 최대화 또는 최소화가 불가능한 경우</p><p>최적화 문제가 DCP rule 위반이 된다.</p><hr /><h2 id="cvxpy-컨벡스-최적화-코드-예시"><span class="mr-2">CVXPY 컨벡스 최적화 코드 예시</span><a href="#cvxpy-컨벡스-최적화-코드-예시" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="n">cp</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span> <span class="c1"># 심볼릭 변수 지정
</span>
<span class="c1"># 목적함수 지정
</span><span class="n">obj2</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

<span class="c1"># 제한조건
</span><span class="n">const</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>

<span class="c1"># 최적화 문제 정의 
</span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj2</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="p">[</span><span class="n">const</span><span class="p">])</span>

<span class="c1"># 문제 풀어라는 명령
</span><span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">()</span>
</pre></table></code></div></div><h1 id="cvxpy로-직접-컨벡스최적화-해보자">CVXPY로 직접 컨벡스최적화 해보자</h1><p>만약 목적함수가 DCP rule 만족하지 않는 경우</p><p>다음과 같은 에러 메시지가 뜬다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1"># DCP rule 만족하지 않는 경우
</span><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="n">cp</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>

<span class="c1"># 목적함수 
</span><span class="n">obj2</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

<span class="c1"># 제한조건 
</span><span class="n">const</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>

<span class="c1"># 최적화문제 정의 
</span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj2</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="p">[</span><span class="n">const</span><span class="p">])</span>
<span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="469" alt="Screen Shot 2021-09-08 at 16 39 53" data-src="https://user-images.githubusercontent.com/83487073/132467081-3e90ae6d-e784-4793-a05c-e94b00f07053.png" data-proofer-ignore></p><p>위 경우에는</p><p>우선 목적함수 obj2 는 $affine$ 이다. 컨벡스 최적화 가능하다.</p><p>하지만, 제한조건 $const$ 를 반영한 최적화 문제가 DCP rule 에 어긋나기 때문에 에러가 발생한 것이다.</p><p>즉, 제한조건 하에서 목적함수 최소화 문제 푸는 게 불가능하다는 말이다.</p><p>라그랑주 승수법으로 제한조건 최적화 목적함수를 직접 구해보면, 가능한 $\lambda$ 값이 두개가 나온다.</p><p>$\lambda = \frac{\sqrt(2)}{2}$ or $-\frac{\sqrt(2)}{2}$</p><p>$\Rightarrow$</p><p>$h_{1} = x_{1}+x_{2} + \frac{\sqrt{2}}{2} (x_{1}^{2}+x_{2}^{2}-1)$</p><p>$h_{2} = x_{1}+x_{2}-\frac{\sqrt{2}}{2} (x_{1}^{2}+x_{1}^{2}-1)$</p><p>위 $h_{1}, h_{2}$ 가 가능한 두가지 목적함수다.</p><p>각 목적함수를 시각화해보면 아래와 같다.</p><h2 id="h_1"><span class="mr-2">$h_{1}$</span><a href="#h_1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">h1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Z1</span> <span class="o">=</span> <span class="n">h1</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">h2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">h2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">'3d'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'flare_r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'1'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'x'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'y'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="581" alt="Screen Shot 2021-09-08 at 16 49 11" data-src="https://user-images.githubusercontent.com/83487073/132468539-b5386b41-383e-495a-b693-18034eb673a3.png" data-proofer-ignore></p><h2 id="h_2"><span class="mr-2">$h_{2}$</span><a href="#h_2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">'3d'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'terrain'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'2'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'x'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'y'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="593" alt="Screen Shot 2021-09-08 at 16 50 21" data-src="https://user-images.githubusercontent.com/83487073/132468744-2a94a6b9-cd82-42fd-943a-8ed911788bc4.png" data-proofer-ignore></p><p>$h_{2}$ 은 $h_{1}$ 를 반대로 엎어놓은 모양이다.</p><p>여기서 핵심은,</p><p>주어진 제한조건</p><p>$x_{1}^{2}+x_{2}^{2} = 1$ 이 최적해에 미치는 영향을 반영해 목적함수를 라그랑주 승수법써서 변형하면서</p><p>가능한 목적함수의 경우가 두 가지 나온다는 것이다.</p><p>두 가지 경우 중 $h_{2}$ 는 concave 함수로, 최소화 연산이 불가능하다.</p><p>사이파이 optimize.minimize 명령을 이용해도 마찬가지였다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">h1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">sp</span><span class="p">.</span><span class="n">optimize</span><span class="p">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></table></code></div></div><p><img width="562" alt="Screen Shot 2021-09-08 at 16 57 58" data-src="https://user-images.githubusercontent.com/83487073/132469804-1cca19b7-30a1-4fcd-9967-9d3ac2d28e53.png" data-proofer-ignore></p><p>그래서 DCP rule 위반이라고 에러 메시지가 발생한 것이었다.</p><p>제한조건을 반영한 목적함수 $h_{1}$ 만 가지고 최소화 연산을 시도했다.</p><p>$h_{1}$ 함수는 컨벡스 함수로, 최소화 연산이 가능할 것이었다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1"># 컨벡스 최적화 1
</span><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="n">cp</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>

<span class="c1"># 목적함수 
</span><span class="n">h</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># 최적화 문제 정의
</span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">value</span>
</pre></table></code></div></div><p><img width="332" alt="Screen Shot 2021-09-08 at 17 00 09" data-src="https://user-images.githubusercontent.com/83487073/132470092-a6daaac5-ed89-4c87-9f30-ee3a6f67bb6c.png" data-proofer-ignore></p><p>원하는 대로 최소화 연산 할 수 있었다.</p><p>한편, $h_{2}$ 는 최대화 연산은 가능할 것이다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1"># 컨벡스 최적화 2
</span><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="n">cp</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>

<span class="c1"># 목적함수 
</span><span class="n">h</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># 최적화 문제 정의
</span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">value</span>
</pre></table></code></div></div><p><img width="336" alt="Screen Shot 2021-09-08 at 17 01 22" data-src="https://user-images.githubusercontent.com/83487073/132470289-c5be2c80-8f6f-426a-b15e-ffa0879cc90d.png" data-proofer-ignore></p><p>예상대로 최대화 할 수 있었다.</p><hr /><h2 id="그러면-이제-dcp-rule-만족하는-경우에-대해-cvxpy-로-컨벡스최적화를-해보자"><span class="mr-2">그러면 이제, DCP rule 만족하는 경우에 대해, CVXPY 로 컨벡스최적화를 해보자.</span><a href="#그러면-이제-dcp-rule-만족하는-경우에-대해-cvxpy-로-컨벡스최적화를-해보자" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>심볼릭연산이다.</ul><p>예1 )</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1"># 컨벡스 최적화 테스트 2
</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="n">cp</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>

<span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span> <span class="c1"># convax 함수인지, concave 함수인지 자동으로 인식한다. 
</span><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">curvature</span><span class="p">)</span> <span class="c1"># 함수가 convex 인지, concave 인지, affine 인지, constant 인지 알려주는 명령
</span>
<span class="c1"># 목적함수 
</span><span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">())</span>

<span class="c1"># 최적화 문제의 정의 
</span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
</pre></table></code></div></div><p>결과 :</p><p>CONVEX</p><p>True</p><p>True</p><p>2.0</p><p>2.0</p><p>단변수함수이면서 컨벡스 함수인 $(x-2)^{2}+2$ 를 CVXPY 로 최적화 했다.</p><p>예2)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c1"># 컨벡스 최적화 테스트 3
</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">curvature</span><span class="p">)</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">())</span> <span class="c1"># 목적함수, 제약조건 종합 고려해서. 목적함수 최소화가 가능한가. 
</span>
<span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">());</span><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
</pre></table></code></div></div><p>결과 :</p><p>CONVEX</p><p>True</p><p>0.5</p><p>0.5</p><p>2차원 다변수함수인 $x^{2}+y^{2}$ 를 CVXPY로 컨벡스최적화 했다.</p><p>물론 함수는 컨벡스함수다.</p><p>제한조건은 $x+y-1=0$ 등식제한조건을 줬다.</p><p>예3)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1"># 컨벡스 최적화 테스트 4
</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">0</span>
<span class="p">]</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">(),</span> <span class="n">x</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
</pre></table></code></div></div><p>결과 : True, 0, 0, 0</p><p>같은 2차원 다변수함수에 대해 이번에는</p><p>$x+y-1$ &lt;= $0$ 부등식제한조건을 줬다.</p><p>예 4)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="c1"># 컨벡스 최적화 테스트 6
</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Variable</span><span class="p">()</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">())</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">,</span>
    <span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">,</span>
    <span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">,</span>
    <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">0</span> 
<span class="p">]</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constraints</span> <span class="o">=</span> <span class="n">constraints</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">prob</span><span class="p">.</span><span class="n">is_dcp</span><span class="p">())</span>

<span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">(),</span> <span class="n">x</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">value</span>
</pre></table></code></div></div><p>True, True,</p><p>(13.0, array(1.), array(-1.11022189e-22))</p><p>이번 시도는 2차원 다변수함수 $(x-4)^{2}+(y-2)^{2}$ 를 가지고 최소화 문제를 풀었다.</p><p>목적함수는 컨벡스 함수다.</p><p>제한조건은 부등식제한조건 4개를 동시에 줬다.</p><hr /><h1 id="cvxopt-1">CVXOPT</h1><p>CVXPY 처럼, 컨벡스최적화 패키지다.</p><p>LP 문제, QP 문제 등을 비롯해 다양한 컨벡스 최적화가 가능했다.</p><ul><li>ndarray 객체를 CVXOPT matrix 자료형으로 변환해서 넣어야 한다.<li>모든 스칼라 값은 부동 소숫점 실수 형태로 바꿔서 넣어야 한다.</ul><h2 id="나는-이-패키지를-lp-문제와-qp-문제-해결을-위해-사용했다"><span class="mr-2">나는 이 패키지를 LP 문제와 QP 문제 해결을 위해 사용했다.</span><a href="#나는-이-패키지를-lp-문제와-qp-문제-해결을-위해-사용했다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>LP 문제와 QP 문제는 뒤에서 다시 정리할 것이다.</p><h2 id="cvxopt-로-lp문제-해결하기"><span class="mr-2">CVXOPT 로 LP문제 해결하기</span><a href="#cvxopt-로-lp문제-해결하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># cvxopt로 선형계획법 풀기 
</span><span class="n">c</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span><span class="o">-</span><span class="mf">5.0</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">],[</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">]]))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">9800.0</span><span class="p">]))</span>

<span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">solvers</span><span class="p">.</span><span class="n">lp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)[</span><span class="s">'x'</span><span class="p">])</span>
</pre></table></code></div></div><p><img width="517" alt="Screen Shot 2021-09-08 at 17 15 59" data-src="https://user-images.githubusercontent.com/83487073/132472402-5477e776-0790-471d-8d0f-7914981ac7ba.png" data-proofer-ignore></p><h2 id="cvxopt-로-qp문제-해결하기"><span class="mr-2">CVXOPT 로 QP문제 해결하기</span><a href="#cvxopt-로-qp문제-해결하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="qp-문제의-목적함수---일반화된-이차형식---이-컨벡스함수인-경우만-최적화-할-수-있다"><span class="mr-2">QP 문제의 목적함수 - 일반화된 이차형식 - 이 컨벡스함수인 경우만 최적화 할 수 있다.</span><a href="#qp-문제의-목적함수---일반화된-이차형식---이-컨벡스함수인-경우만-최적화-할-수-있다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>일반화된 이차형식의 행렬 $Q$ 가 양의 준정부호 여야 한다.<li>$Q$ 가 양의 준정부호가 아니면 넌 컨벡스 함수가 된다. 이 경우, solver.qp 명령으로 이차계획법 문제 못 푼다. 다른 방법 써야 한다.</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1"># 이차계획법 문제 
</span><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">solvers</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">]]))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]]))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]))</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">solvers</span><span class="p">.</span><span class="n">qp</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">A</span><span class="o">=</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)[</span><span class="s">'x'</span><span class="p">]</span>
<span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></table></code></div></div><p>array([[0.5], [0.5]])</p><hr /><h1 id="제한조건-있는-최적화-문제">제한조건 있는 최적화 문제</h1><h2 id="1-등식-제한조건이-있는-최적화-문제"><span class="mr-2">1. 등식 제한조건이 있는 최적화 문제</span><a href="#1-등식-제한조건이-있는-최적화-문제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>최적해가 목적함수를 최소화 하면서도 $f_{i} = 0$ 꼴로 생긴</p><h2 id="연립방정식또는-1개-방정식-을-동시에-만족해야-하는-경우"><span class="mr-2">연립방정식(또는 1개 방정식) 을 동시에 만족해야 하는 경우,</span><a href="#연립방정식또는-1개-방정식-을-동시에-만족해야-하는-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>‘등식 제한조건이 있는 최적화 문제’ 라고 한다.</p><p>(등식 제한조건은 $f = 0$ 형태여야 한다. )</p><hr /><h3 id="등식-제한조건-있는-최적화-예"><span class="mr-2">등식 제한조건 있는 최적화 예)</span><a href="#등식-제한조건-있는-최적화-예" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>목적함수</p><p>$f(x_{1}, x_{2}) = x_{1}^{2}+x_{2}^{2}$</p><p>등식 제한조건</p><p>$g(x_{1}, x_{2}) = x_{1}+x_{2}-1 = 0$</p><p>동시에 만족하는 최적해 $x$ 를 찾아라.</p><p>위 문제는 아래 그림에서 등고선과 붉은 직선이 만나는 벡터 $x$ 를 찾는 것과 같다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">flip</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'gray'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">g</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">'rP'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">'bo'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'목적함수 $x^{2}+y^{2}$를 등식 제한조건 $x_{1}+x_{2}-1=0$ 을 걸고 최적화 '</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$y$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="654" alt="Screen Shot 2021-09-08 at 17 25 58" data-src="https://user-images.githubusercontent.com/83487073/132473995-6edd5206-5eea-4584-8391-62f6f39c52fe.png" data-proofer-ignore></p><hr /><h1 id="라그랑주-승수법">라그랑주 승수법</h1><p>제한조건이 있는 최적화 문제는 라그랑주 승수법을 이용해서 풀 수 있다.</p><p>라그랑주 승수법에서는, 목적함수를 다음과 같이 변형한다.</p><h2 id="h--fx--sum_inlambda_ig_ix"><span class="mr-2">$h = f(x) + \sum_{i}^{n}{\lambda_{i}g_{i}(x)}$</span><a href="#h--fx--sum_inlambda_ig_ix" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>여기서</p><ul><li><p>$g_{i}(x)$ 는 $i$ 번째 제한조건 (등식, 부등식)</p><li><p>$\lambda_{i}$ 는 $i$ 번째 제한조건의 라그랑주 승수</p><li><p>$f(x)$ 는 본래 목적함수</p></ul><p>이다.</p><p>그리고 이처럼 변형된 목적함수 $h$ 를 사용해서 최적화 한다.</p><p>내가 찾는 최적해는 $h$ 의 그레디언트 벡터 $= 0$영벡터 만드는 $x_{1}, x_{2}, …x_{n}$ 값들이다.</p><ul><li>라그랑주 승수는 고려하지 않는다.</ul><h2 id="라그랑주-승수의-의미"><span class="mr-2">라그랑주 승수의 의미</span><a href="#라그랑주-승수의-의미" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>라그랑주 승수 $\lambda_{i}$ 는 ‘각 제한조건이 최적해에 미치는 영향의 크기’를 타나낸다.</p><ul><li>만약 제한조건이 최적해에 아무 영향도 미치지 못하면, 그 제한조건의 라그랑주 승수 $\lambda_{i}$ 는 $0$ 이다.</ul><hr /><p>위에서 풀었던 등식 제한조건 있는 최적화 문제를</p><p>라그랑주 승수법으로 풀어보자.</p><ul><li><p>목적함수 : $f(x_{1}, x_{2}) = x_{1}^{2}+x_{2}^{2}$</p><li><p>등식 제한조건 : $g(x_{1}, x_{2}) = x_{1}+x_{2}-1 = 0$</p></ul><p>였다.</p><p>목적함수 $f$ 를 라그랑주 승수 이용해서 $h$ 로 바꾸자.</p><p>$h = x_{1}^{2}+x_{2}^{2} + \lambda(x_{1}+x_{2}-1)$</p><p>이 목적함수 $h$의 그레디언트 벡터는</p><p>$\nabla{h} = [2x_{1}+\lambda, 2x_{2}+\lambda, x_{1}+x_{2}-1]^{T}$ 이다.</p><p>그레디언트 벡터 각 요소가 $0$ 되게 하는 $\lambda$ , $x_{1}$, $x_{2}$ 를 찾자.</p><p>$\lambda = -1, x_{1}=x_{2} = \frac{1}{2}$</p><p>이다. 따라서 붉은 직선 위 점이면서, 동시에 등고선 플롯 $z$ 값을 최소화 하는 최적해는 $[\frac{1}{2}, \frac{1}{2}]^{T}$ 다.</p><p><img width="654" alt="Screen Shot 2021-09-08 at 17 25 58" data-src="https://user-images.githubusercontent.com/83487073/132473995-6edd5206-5eea-4584-8391-62f6f39c52fe.png" data-proofer-ignore></p><h1 id="사이파이로-등식-제한조건-최적화-하기">사이파이로 등식 제한조건 최적화 하기</h1><p>사이파이의 fmin_slsqp() 명령을 사용하면</p><p>최소자승법 알고리듬을 사용해서 등식 제한조건이 있는 최적화 문제를 해결할 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">sp</span><span class="p">.</span><span class="n">optimize</span><span class="p">.</span><span class="n">fmin_slsqp</span><span class="p">(</span><span class="n">f_name</span><span class="p">,</span> <span class="n">x_</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span> <span class="n">eqcons</span><span class="o">=</span><span class="p">[</span><span class="n">constraint1</span><span class="p">,</span> <span class="n">constraint2</span><span class="p">,...])</span>
</pre></table></code></div></div><ul><li>f_name : 최소화 할 함수 이름<li>x_{0} : 최적화 시작점 (적당한 값 넣으면 된다)<li>eqcons : 제한조건 함수 이름. 리스트 자료형 안에 넣어야 한다.</ul><p>fmin_slsqp() 사용 예 )</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># 위에서 라그랑주 승수법으로 풀었던 문제
</span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>

<span class="n">sp</span><span class="p">.</span><span class="n">optimize</span><span class="p">.</span><span class="n">fmin_slsqp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">eqcons</span><span class="o">=</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
</pre></table></code></div></div><p><img width="425" alt="Screen Shot 2021-09-08 at 17 52 01" data-src="https://user-images.githubusercontent.com/83487073/132478295-9b156cad-a899-4390-8035-25e7ae5eea2e.png" data-proofer-ignore></p><hr /><h1 id="부등식-제한조건-최적화-문제">부등식 제한조건 최적화 문제</h1><p>부등식도 최적화 제한조건으로 걸 수 있다.</p><p>이 경우는 주어진 부등식을 만족하면서, 주어진 목적함수를 최소화 하는 최적해를 찾는 것이다.</p><p>연립부등식이 최적화 제한조건으로 제시된다.</p><p>$g_{j} \leq 0, (j = 1, 2, …M)$</p><p>(부등호 방향은 $g \leq 0$ 이어야 한다. )</p><h2 id="부등식-제한조건-최적화-문제도-라그랑주-승수법으로-풀면-된다"><span class="mr-2">부등식 제한조건 최적화 문제도 라그랑주 승수법으로 풀면 된다.</span><a href="#부등식-제한조건-최적화-문제도-라그랑주-승수법으로-풀면-된다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="h--fx--sum_1nlambda_ig_ix"><span class="mr-2">$h = f(x) + \sum_{1}^{n}{\lambda_{i}g_{i}(x)}$</span><a href="#h--fx--sum_1nlambda_ig_ix" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>등식 제한조건일 때랑 똑같이 변형된 목적함수 $h$ 를 만들면 된다.</p><p>한편, 등식 제한조건 최적화 문제의 최적화 필요조건은 ‘기울기 필요조건’ 이었다.</p><h2 id="부등식-제한조건-최적화-문제의-최적화-필요조건은-kkt-조건-이다"><span class="mr-2">부등식 제한조건 최적화 문제의 최적화 필요조건은 ‘KKT 조건’ 이다.</span><a href="#부등식-제한조건-최적화-문제의-최적화-필요조건은-kkt-조건-이다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>최적해가 만족해야 하는 KKT 조건은 다음과 같다.</p><h2 id="1-fracpartialhpartialx_i--0"><span class="mr-2">1. $\frac{\partial{h}}{\partial{x_{i}}} = 0$</span><a href="#1-fracpartialhpartialx_i--0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>목적함수 $h$ 를 $x_{i}$ 로 미분한 값은 모두 0 이어야 한다.</p><h2 id="2-lambda_i--g_ix--0"><span class="mr-2">2. $\lambda_{i} * g_{i}(x) = 0$</span><a href="#2-lambda_i--g_ix--0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>$\lambda_{i}$ 또는 $g_{i}(x)$ 둘 중 하나는 반드시 0 이어야 한다.</p><p>(둘 다 0 일수도 있다)</p><h2 id="3-lambda_i-ge-0"><span class="mr-2">3. $\lambda_{i} \ge 0$</span><a href="#3-lambda_i-ge-0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>모든 라그랑주 승수는 0 이상이어야 한다.</p><p>위 3 가지 조건 중 2번 조건만 먼저 만족시키면, 1. 3 번 조건은 자연스럽게 만족된다.</p><p>이 2번 조건에 의해 부등식 제한조건은 결국 등식 제한조건 문제 푸는 것과 같아진다.</p><p>case 1</p><p>$\lambda_{i} = 0$ 인 경우</p><p>$i$ 번째 부등식 제한조건이 최적해에 아무런 영향도 못 미친다는 의미다.</p><p>$\lambda_{i} = 0$ 이기 때문에, 목적함수 $h$ 에서 $i$ 번째 부등식 제한조건은 사라진다. ‘쓸모가 없다’.</p><p>case 2</p><p>$g_{i}(x) = 0$ 인 경우</p><p>$g_{i}(x) = 0$ 은 ‘등식 제한조건’ 이었다.</p><p>따라서 등식 제한조건의 $\lambda_{i}$ 도 0 되는 아주 특수한 경우를 제외하고는</p><p>제한조건 $g_{i}(x)$ 는 등식 제한조건과 같아진다.</p><p>따라서 목적함수 $h$ 를 가지고 등식 제한조건 최적화 문제를 풀면(기울기 필요조건 만족) 최적해를 구할 수 있다.</p><hr /><h2 id="rightarrow-결국-부등식-제한조건-최적화-문제는"><span class="mr-2">$\Rightarrow$ 결국 부등식 제한조건 최적화 문제는</span><a href="#rightarrow-결국-부등식-제한조건-최적화-문제는" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="등식-제한조건-최적화-문제-푸는-것과-같다"><span class="mr-2">등식 제한조건 최적화 문제 푸는 것과 같다.</span><a href="#등식-제한조건-최적화-문제-푸는-것과-같다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>부등식 제한조건 최적화 문제)</p><ol><li>라그랑주 승수법으로 목적함수 변형<li>(KKT 조건에 의해) 각 제한조건 없애거나. 등식으로 바꾼다.<li>기울기 필요조건으로 최적화 문제 푼다.</ol><h2 id="rightarrow-제한조건-최적화-문제는-결국-모두-라그랑주-승수법-기울기-필요조건으로-푼다"><span class="mr-2">$\Rightarrow$ 제한조건 최적화 문제는 결국 모두 라그랑주 승수법, 기울기 필요조건으로 푼다.</span><a href="#rightarrow-제한조건-최적화-문제는-결국-모두-라그랑주-승수법-기울기-필요조건으로-푼다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p>부등식 제한조건 최적화 문제를 그림으로 그리면 다음과 같다.</p><p>다음은 목적함수가 $x^{2}+y^{2}$ 이고,</p><p>부등식 제한조건이 각각</p><p>$g_{1}(x_{1}, x_{2}) = x_{1}+x_{2}-1 \leq 0$</p><p>$g_{2}(x_{1}, x_{2}) = -x_{1}-x_{2}+1 \leq 0$</p><p>인 경우다. 따로따로 하나씩 적용했다.</p><h2 id="부등식-제한조건이-g_1-인-경우"><span class="mr-2">부등식 제한조건이 $g_{1}$ 인 경우</span><a href="#부등식-제한조건이-g_1-인-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s">'k'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">con1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">con1</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">con1</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">'ro'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s">'최적해'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'부등식 제한조건이 최적해 에 영향 미치지 못하는 경우'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$y$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="678" alt="Screen Shot 2021-09-08 at 18 38 25" data-src="https://user-images.githubusercontent.com/83487073/132485750-c4159bc7-5a63-4250-b9a9-956bd4b92829.png" data-proofer-ignore></p><p>그림을 보면 이 부등식 제한조건(붉은 직선 아래 푸른색 영역) 은 최적해에 전혀 영향을 못 미치고 있다(쓸모없다).</p><p>라그랑주 승수의 의미는 ‘제한조건이 최적해에 미치는 영향의 크기’ 였다.</p><p>이 제한조건이 최적해에 전혀 영향 못 미치기 때문에, 라그랑주 승수 $\lambda_{1} = 0$ 일 것이다.</p><h2 id="부등식-제한조건이-g_2-인-경우"><span class="mr-2">부등식 제한조건이 $g_{2} 인 경우$</span><a href="#부등식-제한조건이-g_2-인-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="n">CS</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s">'k'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">con2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">con2</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">con2</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s">'ro'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'부등식 제한조건이 최적해에 영향 미치는 경우'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.0003</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'원래 최적해 : $[0,0]$, 바뀐 최적해 : $[0.5, 0.5]$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">'bP'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$y$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="709" alt="Screen Shot 2021-09-08 at 18 40 53" data-src="https://user-images.githubusercontent.com/83487073/132486166-2ea84ac0-96b3-4dbd-8c7f-1d64e3786295.png" data-proofer-ignore></p><p>이 경우에는 부등식 제한조건이 최적해에 영향을 미치고 있다.</p><p>붉은 직선과 푸른색 영역이 부등식 제한조건이다.</p><p>부등식 제한조건 때문에 원래 $[0,0]$ 이었던 최적해가 $[0.5, 0.5]$ 로 바뀌었다.</p><p>이 경우에는 제한조건이 최적해에 영향을 미쳤기 때문에, $\lambda_{2} \ne 0$ 일 것이라 추측해볼 수 있다.</p><p>한편, 위 그림을 잘 보면 제한조건을 만족하는 최적해는 결국 붉은 직선 위의 점이다.</p><p>곧, 새로운 최적해는 부등식 제한조건 영역의 경계선에 걸린다는 말이다.</p><p>푸른색 영역이 뒤로 조금 후퇴해도, 제한조건을 걸면서 변화한 최적해(붉은 점)는 결국 푸른색 영역의 경계선인 붉은 선 위의 값이 될 것이다.</p><p>그러면 결국 원래 목적함수를 최소화 시키는 붉은 직선 위의 점 찾는 문제(= 등식 제한조건 문제) 가 된다.</p><p>따라서 그림으로도 부등식 제한조건이 결국</p><ol><li><p>쓸모없거나,</p><li><p>등식 제한조건이 된다</p></ol><p>는 사실을 확인할 수 있었다.</p><p>다음은 목적함수가 $(x_{1}-4)^{2} + (x_{2}-2)^{2}$ 이고, 부등식 제한조건이 $\sum_{i}^{2}\lvert x_{i} \rvert-1 \leq 0$ 인 최적화 문제를 그림으로 표현한 예다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="n">CS</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">x2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'m'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="o">-</span><span class="n">x3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x3</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'m'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">'ro'</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$x_{1}$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$x_{2}$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'부등식 제한조건 최적화 문제'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="596" alt="Screen Shot 2021-09-08 at 18 52 15" data-src="https://user-images.githubusercontent.com/83487073/132488031-e5f3f8ea-2f74-4e90-becf-cc825239519c.png" data-proofer-ignore></p><p>원래 $[2,4]$ 였던 최적해가 부등식 제한조건 때문에 변해서 붉은 점 $[1,0]$이 됬다.</p><p>붉은 점은 위 그림에서 교차하는 두 붉은 직선 상에 동시에 위치한 점이다.</p><p>즉, 붉은 점은 붉은 두 개 직선이 속한 두 개의 부등식 제한조건 영역 경계에 위치해 있다.</p><p>$\Rightarrow$ 두 직선을 포함하는 두 개 부등식 제한조건 영역들은 모두 등식 제한조건으로 바뀔 것이다.</p><p>나머지 두 개 부등식 제한조건은 붉은 점에 전혀 영향 못 미치고 있다.</p><p>따라서 보라색 마름모의 나머지 두 변을 포함하는 왼쪽 두 개 제한조건들은 할당된 라그랑주 승수 $\lambda_{i}$ 값이 $0$ 일 것이다(쓸모없음).</p><hr /><h1 id="사이파이로-부등식-제한조건-있는-함수-최적화-하기">사이파이로 부등식 제한조건 있는 함수 최적화 하기</h1><p>등식 제한조건 최적화 할 때 사용했던 fmin_slsqp 명령을 다시 쓸 수 있다.</p><p>fmin_slsqp 명령은 ieqcons= 라는 argument 로 부등식 제한조건 함수를 받는다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">sp</span><span class="p">.</span><span class="n">optimize</span><span class="p">.</span><span class="n">fmin_slsqp</span><span class="p">(</span><span class="n">함수이름</span><span class="p">,</span> <span class="n">최적화시작점</span><span class="p">,</span> <span class="n">ieqcons</span><span class="o">=</span><span class="p">[</span><span class="n">부등식제한조건</span> <span class="n">함수이름</span><span class="p">])</span>
</pre></table></code></div></div><p>*부등식 제한조건을 ieqcons argument 에 넣을 때는 부등호 방향을 $\ge$ 이 되게 해서 넣어야 한다.</p><p>위 예제를 사이파이로 최적화 해보자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ieqcons</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span>

<span class="n">sp</span><span class="p">.</span><span class="n">optimize</span><span class="p">.</span><span class="n">fmin_slsqp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ieqcons</span><span class="o">=</span><span class="p">[</span><span class="n">ieqcons</span><span class="p">])</span>
</pre></table></code></div></div><p><img width="483" alt="Screen Shot 2021-09-08 at 19 02 36" data-src="https://user-images.githubusercontent.com/83487073/132489667-0723e466-4a3e-4209-88a0-93a6e864a783.png" data-proofer-ignore></p><h2 id="데이터사이언스-스쿨-523-연습문제-"><span class="mr-2">데이터사이언스 스쿨 5.2.3 연습문제 )</span><a href="#데이터사이언스-스쿨-523-연습문제-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>위 예제 문제에서 제한조건을 다음과 같이 바꾼다.</p><p>$g(x) = \lvert x_{1} \rvert$ + $\lvert x_{1} \rvert - k = \sum_{i}^{2}{\lvert x_{i}\rvert}-k \leq 0$</p><p>$k$ 를 0.1 부터 10까지 변화시키면서, 최적화 해가 어떻게 바뀌는지 살펴봐라.</p><p>나의 답 )</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c1"># 5.2.4 연습문제 
</span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s">'r'</span><span class="p">,</span> <span class="s">'g'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'m'</span><span class="p">,</span> <span class="s">'k'</span><span class="p">,</span> <span class="s">'y'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">x1</span><span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="o">-</span><span class="n">x2</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="n">x2</span><span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
    <span class="n">c</span><span class="o">+=</span><span class="mi">1</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'$k$ 가 변하면서, 최적화 해에 영향 미치는 부등식 제한조건도 변한다'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.0004</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'$k$가 일정 정도 이상 커지면 모든 부등식 제한조건이 최적화 해에 영향 못 미친다'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="597" alt="Screen Shot 2021-09-08 at 19 06 04" data-src="https://user-images.githubusercontent.com/83487073/132490132-2274166c-c3f3-40f8-8744-aee14d993340.png" data-proofer-ignore></p><p>겹쳐진 여러 마름모가 변화된 $k$ 를 입력받은 부등식 제한조건 영역이다.</p><p>원래 최적해는 $[4,2]$ 였다.</p><p>보면 $k$ 가 일정 정도 이상 커지면, 4개 부등식 제한조건 모두 최적화 해에 영향 못 미친다는 사실을 관찰할 수 있었다.</p><p>(부등식 제한조건 영역이 최적해 $[4,2]$ 를 포함해 버린다)</p><p>더 자세히 보면</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s">'r'</span><span class="p">,</span> <span class="s">'g'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'m'</span><span class="p">,</span> <span class="s">'k'</span><span class="p">,</span> <span class="s">'y'</span><span class="p">]</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> 

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">600</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="o">+</span><span class="n">k</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="o">-</span><span class="n">x1</span><span class="o">-</span><span class="n">k</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="o">-</span><span class="n">x2</span><span class="o">+</span><span class="n">k</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">x2</span><span class="o">-</span><span class="n">k</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'$k = </span><span class="si">{</span><span class="n">k</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="s">$ 인 경우'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">'ro'</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="595" alt="Screen Shot 2021-09-08 at 19 08 32" data-src="https://user-images.githubusercontent.com/83487073/132490523-237427e1-7fe2-4a9a-8ab2-18b093865ec7.png" data-proofer-ignore></p><p><img width="596" alt="Screen Shot 2021-09-08 at 19 08 53" data-src="https://user-images.githubusercontent.com/83487073/132490565-32ffa3eb-4268-48fb-aabd-a456c48749af.png" data-proofer-ignore></p><p><img width="600" alt="Screen Shot 2021-09-08 at 19 09 16" data-src="https://user-images.githubusercontent.com/83487073/132490621-b956ef3e-552a-4b1a-a405-3534681f8e01.png" data-proofer-ignore></p><p><img width="596" alt="Screen Shot 2021-09-08 at 19 09 35" data-src="https://user-images.githubusercontent.com/83487073/132490674-6a0a858c-7f23-4e7b-877a-e4bf7c8c39f1.png" data-proofer-ignore></p><p><img width="599" alt="Screen Shot 2021-09-08 at 19 10 06" data-src="https://user-images.githubusercontent.com/83487073/132490759-046e5154-a8b6-4f1f-85b0-58ceabbf1666.png" data-proofer-ignore></p><p>이런식으로 변화한다. $k$ 가 커질 수록 부등식 제한조건 영역이 원래 최적해 $[4,2]$ 가까이 간다는 사실을 관찰할 수 있었다.</p><p>또</p><p>$k = 6.7$ 일 때는 본래 최적해가 부등식 제한조건 영역 안에 완전히 포함되었다. 곧, 부등식 제한조건이 더 이상 최적해에 영향 미치지 못했다 $\lambda_{i} = 0$</p><h2 id="한편-1"><span class="mr-2">한편</span><a href="#한편-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>부등식 제한조건을 감안한 최적해를 $[x_{1}, x_{2}]$ 라고 보고, $k$값이 변화할 때(부등식 제한조건이 변할 때) 이 벡터의 $x$ 좌표와 $y$ 좌표 값이 어떻게 변해가는지도 그래프로 나타내 봤다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">ieq_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="n">k</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">result</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">optimize</span><span class="p">.</span><span class="n">fmin_slsqp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">ieqcons</span><span class="o">=</span><span class="p">[</span><span class="n">ieq_constraint</span><span class="p">],</span> <span class="n">iprint</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x1</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">x2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">x1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'$x_{1}$의 최적해'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">x2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">':'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'$x_{2}$의 최적해'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$k$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'$x_{i}$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'$k$값 변화에 따른 $x_{1}, x_{2}$ 최적해 변화'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="596" alt="Screen Shot 2021-09-08 at 19 13 46" data-src="https://user-images.githubusercontent.com/83487073/132491331-c3928211-5f97-4706-a296-53be34d890ca.png" data-proofer-ignore></p><p>보면 $k$ 값이 커지면서 $x_{1}$, $x_{2}$ 값도 함께 커져감을 관찰할 수 있다.</p><p>그리고 $k = 6$ 에 도달했을 때 부터는 $x_{1}, x_{2}$ 도 더 이상 변화하지 않았다.</p><h2 id="곧-k-ge-6-에서-k-값-변화가-최적해-x_1-x_2-에-더-이상-영향-미치지-못했다"><span class="mr-2">곧, $k \ge 6$ 에서 $k$ 값 변화가 최적해 $[x_{1}, x_{2}]$ 에 더 이상 영향 미치지 못했다.</span><a href="#곧-k-ge-6-에서-k-값-변화가-최적해-x_1-x_2-에-더-이상-영향-미치지-못했다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/bioinfo.github.io/categories/data-science/'>Data Science</a>, <a href='/bioinfo.github.io/categories/python/'>python</a>, <a href='/bioinfo.github.io/categories/mathematics/'>mathematics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/bioinfo.github.io/tags/mathematics/" class="post-tag no-text-decoration" >mathematics</a> <a href="/bioinfo.github.io/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/bioinfo.github.io/tags/datascience/" class="post-tag no-text-decoration" >datascience</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5B%EC%88%98%ED%95%99%2F%EC%B5%9C%EC%A0%81%ED%99%94%5D+%EC%A0%84%EC%97%AD+%EC%B5%9C%EC%A0%81%ED%99%94%2C+%EC%BB%A8%EB%B2%A1%EC%8A%A4+%EC%B5%9C%EC%A0%81%ED%99%94%2C+%EC%A0%9C%ED%95%9C%EC%A1%B0%EA%B1%B4+%EC%B5%9C%EC%A0%81%ED%99%94+-+der+Wille+zur+Macht&url=https%3A%2F%2Ftigerkey10.github.io%2Fbioinfo.github.io%2Fposts%2Fglobal_convex_optimization%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5B%EC%88%98%ED%95%99%2F%EC%B5%9C%EC%A0%81%ED%99%94%5D+%EC%A0%84%EC%97%AD+%EC%B5%9C%EC%A0%81%ED%99%94%2C+%EC%BB%A8%EB%B2%A1%EC%8A%A4+%EC%B5%9C%EC%A0%81%ED%99%94%2C+%EC%A0%9C%ED%95%9C%EC%A1%B0%EA%B1%B4+%EC%B5%9C%EC%A0%81%ED%99%94+-+der+Wille+zur+Macht&u=https%3A%2F%2Ftigerkey10.github.io%2Fbioinfo.github.io%2Fposts%2Fglobal_convex_optimization%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftigerkey10.github.io%2Fbioinfo.github.io%2Fposts%2Fglobal_convex_optimization%2F&text=%5B%EC%88%98%ED%95%99%2F%EC%B5%9C%EC%A0%81%ED%99%94%5D+%EC%A0%84%EC%97%AD+%EC%B5%9C%EC%A0%81%ED%99%94%2C+%EC%BB%A8%EB%B2%A1%EC%8A%A4+%EC%B5%9C%EC%A0%81%ED%99%94%2C+%EC%A0%9C%ED%95%9C%EC%A1%B0%EA%B1%B4+%EC%B5%9C%EC%A0%81%ED%99%94+-+der+Wille+zur+Macht" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="tigerkey10/bioinfo.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/bioinfo.github.io/posts/logical_writing1/">[Logical Writing Study 01] Subject : Should Generative A.I. Be Regulated by Law?</a><li><a href="/bioinfo.github.io/posts/classifier/">[알고리즘/지도학습] 로지스틱 회귀, 서포트벡터 머신, 나이브 베이즈 알고리듬, 분류모형 별 성능 비교</a><li><a href="/bioinfo.github.io/posts/regressor/">[알고리즘/지도학습] 회귀문제 - 선형회귀, 의사결정회귀나무, 의사결정회귀나무 앙상블(그래디언트 부스트)</a><li><a href="/bioinfo.github.io/posts/boosting/">[알고리즘/지도학습] 앙상블 알고리즘-부스팅(에이다 부스트, 그래디언트 부스트)</a><li><a href="/bioinfo.github.io/posts/ensemble/">[알고리즘/지도학습] 앙상블 알고리즘-취합(다수결 투표, 배깅, 랜덤포레스트)</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/bioinfo.github.io/tags/study/">study</a> <a class="post-tag" href="/bioinfo.github.io/tags/python/">python</a> <a class="post-tag" href="/bioinfo.github.io/tags/mathematics/">mathematics</a> <a class="post-tag" href="/bioinfo.github.io/tags/data-science/">data science</a> <a class="post-tag" href="/bioinfo.github.io/tags/computer-science/">computer science</a> <a class="post-tag" href="/bioinfo.github.io/tags/datascience/">datascience</a> <a class="post-tag" href="/bioinfo.github.io/tags/data-structure/">data structure</a> <a class="post-tag" href="/bioinfo.github.io/tags/algorithm/">algorithm</a> <a class="post-tag" href="/bioinfo.github.io/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/bioinfo.github.io/tags/ml/">ML</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/bioinfo.github.io/posts/baysian/"><div class="card-body"> <em class="small" data-ts="1624460400" data-df="YYYY-MM-DD" > 2021-06-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률론] 베이즈 정리</h3><div class="text-muted small"><p> 2021-06-24 베이즈정리 복습 베이즈 정리 중간에 들어온 정보로 인해(사건 B가 발생) 사건 A 사전확률이 어떻게 사후확률로 변하는지 보여준다. $P(A\vert{B}) = \frac{P(B\vert{A})P(A)}{P(B)}$ $P(A)$ : 사전확률 $P(B\vert{A})$ : 가능도 $P(B)$ : 정규화상수...</p></div></div></a></div><div class="card"> <a href="/bioinfo.github.io/posts/random_variable_vector_and_others/"><div class="card-body"> <em class="small" data-ts="1624806000" data-df="YYYY-MM-DD" > 2021-06-28 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률과 통계] 확률변수벡터, 결합.조건부.주변확률분포, 확률변수 독립</h3><div class="text-muted small"><p> 다변수 확률변수 벡터를 표본으로 내놓는 확률변수 결합확률분포함수는 기본적으로 다변수함수다 (입력변수 여러개-벡터 / 출력변수 1개-스칼라) 따라서 결합확률분포함수는 3d 서피스플롯 등 3차원 그래프로 나타낼 수 있다. 예컨대 P_XY(x,y) 라는 결합확률질량함수가 있다. 이 함수는 2차원 벡터 $[x, y]$ 의 확률질량값을 할당하는 함...</p></div></div></a></div><div class="card"> <a href="/bioinfo.github.io/posts/covariance/"><div class="card-body"> <em class="small" data-ts="1624978800" data-df="YYYY-MM-DD" > 2021-06-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/메모] 다변수확률변수 공분산_메모</h3><div class="text-muted small"><p> 표본 공분산 일반적인 확률변수는 시뮬레이션(=시행) 한 번 할 때 마다 스칼라 표본 하나씩을 내놓는다. 이 표본은 확률적 데이터로, 확률변수의 확률분포에 따라 현실세계로 튕겨져 나온 ‘데이터’다. 만약 스칼라 표본을 내놓는 이러한 확률변수가 $X,Y$ 둘이 있다고 가정해보자. 표본 공분산은 $x$ 표본과 $y$ 표본이 동시에 $x$ 평균과 $y...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/bioinfo.github.io/posts/optimization_theory/" class="btn btn-outline-primary" prompt="이전 글"><p>[수학/최적화] 최적화 개념, 그리드서치 방법, 수치적 최적화 방법</p></a> <a href="/bioinfo.github.io/posts/linear_quadratic_programming/" class="btn btn-outline-primary" prompt="다음 글"><p>[수학/최적화] 선형계획법(LP문제), 이차계획법(QP) 문제</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a>.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/bioinfo.github.io/tags/study/">study</a> <a class="post-tag" href="/bioinfo.github.io/tags/python/">python</a> <a class="post-tag" href="/bioinfo.github.io/tags/mathematics/">mathematics</a> <a class="post-tag" href="/bioinfo.github.io/tags/data-science/">data science</a> <a class="post-tag" href="/bioinfo.github.io/tags/computer-science/">computer science</a> <a class="post-tag" href="/bioinfo.github.io/tags/datascience/">datascience</a> <a class="post-tag" href="/bioinfo.github.io/tags/data-structure/">data structure</a> <a class="post-tag" href="/bioinfo.github.io/tags/algorithm/">algorithm</a> <a class="post-tag" href="/bioinfo.github.io/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/bioinfo.github.io/tags/ml/">ML</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/bioinfo.github.io/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/bioinfo.github.io/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/bioinfo.github.io/app.js"></script>
